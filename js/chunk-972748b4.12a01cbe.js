(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-972748b4"],{"1b5f":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-text-field",t._b({attrs:{value:t.value,autocomplete:"current-password","append-icon":t.show?"mdi-eye":"mdi-eye-off",type:t.show?"text":"password",counter:""},on:{input:function(e){return t.$emit("input",e)},"click:append":function(e){t.show=!t.show}}},"v-text-field",t.$attrs,!1))},i=[],l={name:"password",props:{value:String},data:function(){return{show:!1}}},r=l,o=a("2877"),s=a("6544"),c=a.n(s),u=a("8654"),d=Object(o["a"])(r,n,i,!1,null,null,null);e["a"]=d.exports;c()(d,{VTextField:u["a"]})},9320:function(t,e,a){},9894:function(t,e,a){"use strict";var n=a("9320"),i=a.n(n);i.a},bb0b:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"100%"}},[a("v-autocomplete",t._b({attrs:{value:t.value,"search-input":t.search,items:t.dataItems,loading:t.loading,clearable:"","no-filter":Boolean(t.collection),"return-object":""},on:{"update:searchInput":function(e){t.search=e},"update:search-input":function(e){t.search=e},input:t.emit,focus:function(e){return t.makeSearch(t.search)}},scopedSlots:t._u([!t.hideAddNew&&t.writeAccess?{key:"prepend-item",fn:function(){return[a("v-list-item",{on:{click:t.addNew}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"green--text"},[a("v-icon",{attrs:{color:"green"}},[t._v("mdi-plus")]),t._v(" Add New")],1)],1)],1)]},proxy:!0}:null,"bank"==t.collection?{key:"item",fn:function(e){var n=e.parent,i=e.item;return[a("v-list-item-avatar",[a("v-icon",[t._v("mdi-bank")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(i[n.$props.itemText]))]),a("v-list-item-subtitle",[t._v(" "+t._s(t.getCountry(i.country))+" ")])],1)]}}:null,"bank"==t.collection?{key:"selection",fn:function(e){var n=e.parent,i=e.item;return[a("small",{staticClass:"pr-1"},[t._v(" ("+t._s(t.getCountry(i.country))+") ")]),t._v(" "+t._s(i[n.$props.itemText])+" ")]}}:null],null,!0)},"v-autocomplete",t.$attrs,!1)),a("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("app-item",{attrs:{"collection-name":t.collection},on:{close:function(e){t.dialog=!1},save:t.newSave}})],1)],1)],1)},i=[],l=(a("4de4"),a("4160"),a("b0c0"),a("b64b"),a("159b"),a("2909")),r=a("ade3"),o=(a("96cf"),a("1da1")),s=a("5530"),c=a("b012"),u=a.n(c),d=a("2f62"),f=a("445d"),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-col",{staticClass:"pa-0"},[a("v-toolbar",{attrs:{dark:"",color:"primary"}},[a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){return t.$emit("close")}}},[a("v-icon",[t._v("mdi-close")])],1),a("v-toolbar-title",[t._v(t._s(t.title))]),a("v-spacer"),t.writeAccess?a("v-toolbar-items",[a("v-btn",{attrs:{dark:"",text:""},on:{click:t.validate}},[t._v("Save")])],1):t._e()],1),t.found?a("v-card",{attrs:{flat:""}},[a("v-card-title",[t._v(" "+t._s(t.title)+" ")]),a("v-card-text",[t.tabs.length>1?a("v-tabs",{attrs:{"center-active":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.tabs,(function(e,n){return a("v-tab",{key:n},[t._v(" "+t._s(e)+" ")])})),1):t._e(),a("v-form",{ref:"form"},[t.loading?t._e():a("v-tabs-items",{attrs:{"center-active":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.tabs,(function(e,n){return a("v-tab-item",{key:n,staticClass:"px-5"},t._l(t.filteredFields,(function(e,n){return a("v-row",{key:n},[a(t.inputs[e.input],t._g(t._b({ref:t.$route.params.collection+"_"+e.name,refInFor:!0,tag:"component",model:{value:t.data[e.name],callback:function(a){t.$set(t.data,e.name,a)},expression:"data[field.name]"}},"component",e.bind,!1),"function"==typeof e.on?e.on(t.vm):e.on))],1)})),1)})),1)],1)],1)],1):a("v-not-found")],1)},m=[],p=(a("d81d"),a("ac1f"),a("1276"),a("8654")),h=a("b974"),b=a("b73d"),w=a("1b5f"),g=a("e94a"),x=a("d6a0"),k=a("fb57"),_={name:"AppItem",props:{collectionName:String},data:function(){return{showFields:[],loading:!1,collection:null,tab:0,form:null,found:!0,title:"",data:{},inputs:{text:p["a"],select:h["a"],switch:b["a"],date:g["a"],autocomplete:Z,password:w["a"],rights:x["a"]}}},computed:{vm:function(){return this},filteredFields:function(){var t=this;return this.fields.filter((function(e,a){return t.showFields[t.tab][a]}))},tabs:function(){var t=this;return this.form?this.form.filter((function(e){return"function"==typeof e.if?e.if(t):"boolean"!=typeof e.if||e.if})).map((function(t){return t.label})):[]},fields:function(){return this.form?this.form[this.tab].fields:[]},access:function(){var t=this;return this.$store.state.auth.user.rights?this.$store.state.auth.user.rights.filter((function(e){return e.collection==t.collection})):[]},writeAccess:function(){return this.access.length>0&&this.access[0].write.value}},methods:Object(s["a"])(Object(s["a"])({},Object(d["b"])({save:"api/save",success:"success"})),{},{generateDataInputs:function(t,e){var a=this,n={},i={};t.forEach((function(t,l){a.showFields[l]=[],t.fields.forEach((function(t,r){if("function"==typeof t.if?a.showFields[l][r]=t.if(a.$store.state):a.showFields[l][r]=!0,"password"==t.name)return n[t.name]="";"date"==t.input&&e[t.name]&&(e[t.name]=e[t.name].split("T")[0]),n[t.name]="",e[t.name]?n[t.name]=e[t.name]:t.default&&(n[t.name]="function"==typeof t.default?t.default(a.$store.state):t.default),"date"==t.input&&(i[t.name]=!1)}))})),this.data=n,this.menu=i},validate:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.data,n=t.collection,i=t.title,!t.$refs.form.validate()){e.next=11;break}return e.next=4,t.save({collection:n,data:a});case 4:if(l=e.sent,!l){e.next=9;break}return e.next=8,t.$store.commit("success",i+" saved successfuly");case 8:t.$emit("save",l.data);case 9:e.next=12;break;case 11:t.$store.commit("error","form not valid");case 12:case"end":return e.stop()}}),e)})))()}}),mounted:function(){window.$form=this},destroyed:function(){window.$form=null},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=k["default"].get(t.collectionName),t.collection=t.collectionName,a?(t.title=a.title,t.form=a.form,n={},t.generateDataInputs(t.form,n)):t.found=!1;case 3:case"end":return e.stop()}}),e)})))()}},O=_,V=(a("9894"),a("2877")),$=a("6544"),y=a.n($),I=a("8336"),T=a("b0af"),j=a("99d9"),A=a("62ad"),F=a("4bd4"),S=a("132d"),C=a("0fd9"),R=a("2fa4"),E=a("71a3"),L=a("c671"),N=a("fe57"),D=a("aac8"),q=a("71d9"),B=a("2a7f"),J=Object(V["a"])(O,v,m,!1,null,null,null),M=J.exports;y()(J,{VBtn:I["a"],VCard:T["a"],VCardText:j["d"],VCardTitle:j["e"],VCol:A["a"],VForm:F["a"],VIcon:S["a"],VRow:C["a"],VSpacer:R["a"],VTab:E["a"],VTabItem:L["a"],VTabs:N["a"],VTabsItems:D["a"],VToolbar:q["a"],VToolbarItems:B["b"],VToolbarTitle:B["c"]});var P=a("1157"),U=a.n(P),W={name:"autocomplete",components:{AppItem:M},props:{value:String,searchFields:[String,Array],hideAddNew:Boolean,query:Object,collection:{type:String},or:{type:Boolean,default:!0}},data:function(){return{search:"",dataItems:[],loading:!1,dialog:!1}},computed:{access:function(){var t=this;return this.$store.state.auth.user.rights?this.$store.state.auth.user.rights.filter((function(e){return e.collection==t.collection})):[]},writeAccess:function(){return this.access.length>0&&this.access[0].write.value}},methods:Object(s["a"])(Object(s["a"])({getCountry:function(t){var e=f["a"].filter((function(e){return e.code==t}));return e.length?e[0].name:"N/A"},emit:function(t){this.$emit("input",t?t[this.$attrs.itemValue]:""),this.$emit("data",t)},addNew:function(){this.dialog=!0},newSave:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.dialog=!1,e.dataItems.push(t),e.$emit("input",t[e.$attrs.itemValue]);case 3:case"end":return a.stop()}}),a)})))()}},Object(d["b"])({get:"api/get"})),{},{makeSearch:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.collection){a.next=2;break}return a.abrupt("return");case 2:return e.loading=!0,n={},e.searchFields?Array.isArray(e.searchFields)?e.searchFields.forEach((function(e){t&&(n[e]="^"+t)})):t&&(n[e.searchFields]="^"+t):t&&(n[e.$attrs.itemText]="^"+t),e.query&&Object.keys(e.query).length>0&&(n=Object.assign(n,e.query)),console.log(n),a.next=9,e.get({collection:e.collection+"?"+U.a.param(n)+(e.or?"&or=true":"")});case 9:i=a.sent,e.dataItems=i.data.docs,e.loading=!1;case 12:case"end":return a.stop()}}),a)})))()}}),watch:{search:function(t){this.collection&&null!==t&&u()(this.makeSearch,500)(t)}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.collection||!t.value){e.next=5;break}return e.next=3,t.get({collection:t.collection,query:Object(r["a"])({},t.$attrs.itemValue,t.value)});case 3:a=e.sent,a&&a.data&&a.data.docs?(t.dataItems=Object(l["a"])(a.data.docs),t.$emit("init",a.data.docs)):a&&a.data&&(t.dataItems=Object(l["a"])(a.data),t.$emit("init",a.data));case 5:t.$attrs.items&&(t.dataItems=t.$attrs.items);case 6:case"end":return e.stop()}}),e)})))()}},z=W,G=a("c6a6"),H=a("169a"),K=a("da13"),Q=a("8270"),X=a("5d23"),Y=Object(V["a"])(z,n,i,!1,null,null,null),Z=e["a"]=Y.exports;y()(Y,{VAutocomplete:G["a"],VCard:T["a"],VDialog:H["a"],VIcon:S["a"],VListItem:K["a"],VListItemAvatar:Q["a"],VListItemContent:X["g"],VListItemSubtitle:X["j"],VListItemTitle:X["k"]})},d6a0:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{flat:"",width:"100%"}},[a("v-card-text",{staticClass:"text-center"},[a("v-divider"),a("h2",{staticClass:"my-5"},[t._v(t._s(t.label))]),a("v-divider"),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.data,expanded:t.expanded,"item-key":"collection","show-expand":""},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"expanded-item",fn:function(e){var n=e.headers,i=e.item;return[a("td",{staticClass:"pa-0",attrs:{colspan:n.length}},[a("v-simple-table",[a("tr",[a("th",[t._v("Read")]),a("td",[a("v-switch",{on:{change:function(e){return t.handelReadRight(e,i)}},model:{value:i.read.value,callback:function(e){t.$set(i.read,"value",e)},expression:"item.read.value"}})],1),a("td",[a("v-select",{attrs:{label:"Own / All",items:t.AllOwn},model:{value:i.read.allOwn,callback:function(e){t.$set(i.read,"allOwn",e)},expression:"item.read.allOwn"}})],1)]),a("tr",[a("th",[t._v("Write")]),a("td",[a("v-switch",{model:{value:i.write.value,callback:function(e){t.$set(i.write,"value",e)},expression:"item.write.value"}})],1),a("td",[a("v-select",{attrs:{label:"Own / All",items:t.AllOwn},model:{value:i.write.allOwn,callback:function(e){t.$set(i.write,"allOwn",e)},expression:"item.write.allOwn"}})],1)]),a("tr",[a("th",[t._v("Update")]),a("td",[a("v-switch",{model:{value:i.update.value,callback:function(e){t.$set(i.update,"value",e)},expression:"item.update.value"}})],1),a("td",[a("v-select",{attrs:{label:"Own / All",items:t.AllOwn},model:{value:i.update.allOwn,callback:function(e){t.$set(i.update,"allOwn",e)},expression:"item.update.allOwn"}})],1)]),a("tr",[a("th",[t._v("Delete")]),a("td",[a("v-switch",{model:{value:i.delete.value,callback:function(e){t.$set(i.delete,"value",e)},expression:"item.delete.value"}})],1),a("td",[a("v-select",{attrs:{label:"Own / All",items:t.AllOwn},model:{value:i.delete.allOwn,callback:function(e){t.$set(i.delete,"allOwn",e)},expression:"item.delete.allOwn"}})],1)])])],1)]}},{key:"item.fields",fn:function(e){var n=e.item;return[a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.showFields(n)}}},[a("v-icon",[t._v("mdi-table-border")])],1)]}}])})],1),a("v-dialog",{attrs:{"max-width":"650"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",[t._v(" "+t._s(t.dialogTitle)+" "),a("v-spacer"),a("v-icon",{on:{click:function(e){t.dialog=!1}}},[t._v("mdi-close")])],1),a("v-card-text",[a("v-list",t._l(t.fields,(function(e){return a("v-list-item",{key:e.value},[a("v-list-item-icon",[a("v-switch",{staticClass:"ma-0",attrs:{"hide-details":""},model:{value:t.dialogFields[t.btoa(e.value)],callback:function(a){t.$set(t.dialogFields,t.btoa(e.value),a)},expression:"dialogFields[btoa(field.value)]"}})],1),a("v-list-item-content",[a("v-list-item-title",[t._v(" "+t._s(e.text)+" ")])],1)],1)})),1)],1)],1)],1)],1)},i=[],l=(a("4de4"),a("4160"),a("d81d"),a("d3b7"),a("25f0"),a("159b"),a("96cf"),a("1da1")),r=a("fb57"),o={name:"Rights",props:{label:String,value:{type:Array,default:function(){return[]}}},data:function(){return{AllOwn:[{text:"All",value:"all"},{text:"Own",value:"own"}],dialog:!1,dialogTitle:"",dialogFields:{},fields:[],expanded:[],singleExpand:!1,selected:"",collections:[],headers:[{text:"Collection",value:"title",width:"80%",sortable:!1},{text:"Table Fields",value:"fields",sortable:!1}],data:[]}},methods:{btoa:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return btoa(t)})),select:function(t){var e=this;setTimeout((function(){return e.selected=""}),10),this.data.push({collection:t})},handelReadRight:function(t,e){t||(e.write.value=!1,e.update.value=!1,e.delete.value=!1)},showFields:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=r["default"].get(t.collection),e.dialog=!0,e.dialogTitle="Table Fields of (".concat(n.title,")"),e.fields=n.items.headers.filter((function(t){return"actions"!=t.value})),e.dialogFields=e.data.filter((function(e){return e.collection==t.collection}))[0].fields;case 5:case"end":return a.stop()}}),a)})))()}},watch:{data:{deep:!0,handler:function(t){this.$emit("input",t)}}},mounted:function(){var t=this;this.value.length<1&&this.$emit("input",this.data),this.value.forEach((function(e){var a=t.data.filter((function(t){return t.value==e.value}));a[0]&&Object.assign(a[0],e)}))},created:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("api/get",{collection:"collections"});case 2:a=e.sent,a&&a.data&&(t.data=a.data.map((function(t){var e={},a=r["default"].get(t);if(a)return a.items.headers.forEach((function(t){"actions"!=t.value&&(e[btoa(t.value)]=!0)})),{collection:t,title:a.title,fields:e,read:{value:!0,allOwn:"all"},write:{value:!0,allOwn:"all"},update:{value:!0,allOwn:"all"},delete:{value:!0,allOwn:"all"}}}))),console.log(t.data),t.value&&(n=[],t.data.forEach((function(e){var a=t.value.filter((function(t){return!!t&&t.collection==e.collection}));a.length?n.push(Object.assign({},e,a[0])):n.push(e)})),t.data=n);case 6:case"end":return e.stop()}}),e)})))()}},s=o,c=a("2877"),u=a("6544"),d=a.n(u),f=a("8336"),v=a("b0af"),m=a("99d9"),p=a("8fea"),h=a("169a"),b=a("ce7e"),w=a("132d"),g=a("8860"),x=a("da13"),k=a("5d23"),_=a("34c3"),O=a("b974"),V=a("1f4f"),$=a("2fa4"),y=a("b73d"),I=Object(c["a"])(s,n,i,!1,null,null,null);e["a"]=I.exports;d()(I,{VBtn:f["a"],VCard:v["a"],VCardText:m["d"],VCardTitle:m["e"],VDataTable:p["a"],VDialog:h["a"],VDivider:b["a"],VIcon:w["a"],VList:g["a"],VListItem:x["a"],VListItemContent:k["g"],VListItemIcon:_["a"],VListItemTitle:k["k"],VSelect:O["a"],VSimpleTable:V["a"],VSpacer:$["a"],VSwitch:y["a"]})},e94a:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-text-field",t._g(t._b({attrs:{readonly:"",value:t.getValue,clearable:""},on:{"click:clear":function(e){return t.input("")}}},"v-text-field",t.$attrs,!1),n))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-date-picker",{attrs:{value:t.getValue},on:{input:t.input}})],1)},i=[],l=(a("ac1f"),a("1276"),{name:"date-picker",props:{value:String},data:function(){return{menu:!1}},computed:{getValue:function(){return this.value.split("T")[0]}},methods:{input:function(t){this.menu=!1,this.$emit("input",t)}}}),r=l,o=a("2877"),s=a("6544"),c=a.n(s),u=a("2e4b"),d=a("e449"),f=a("8654"),v=Object(o["a"])(r,n,i,!1,null,null,null);e["a"]=v.exports;c()(v,{VDatePicker:u["a"],VMenu:d["a"],VTextField:f["a"]})}}]);
//# sourceMappingURL=chunk-972748b4.12a01cbe.js.map