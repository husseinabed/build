(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b01faab8"],{"1dde3":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{flat:"",color:t.color,dark:"",elevation:"1"}},[t.loading?a("v-card-title",{staticClass:"pb-0"},[a("v-skeleton-loader",{attrs:{type:"heading"}})],1):a("v-card-title",{staticClass:"pb-0"},[t.icon?a("v-icon",{staticClass:"px-2",attrs:{dark:""}},[t._v(t._s(t.icon))]):t._e(),t._v(" "+t._s(t.title)+" "),a("v-spacer"),t.appendIcon?a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){return t.$emit("click:icon")}}},[a("v-icon",[t._v(t._s(t.appendIcon))])],1):t._e()],1),a("v-card-text",[t.loading?a("v-row",[t.deposit?a("v-col",{staticClass:" white--text"},[a("v-skeleton-loader",{attrs:{type:"heading"}})],1):t._e(),a("v-col",{staticClass:" white--text"},[a("v-skeleton-loader",{attrs:{type:"heading"}})],1)],1):a("v-row",[t.deposit?a("v-col",{staticClass:" white--text"},[a("small",[t._v("Deposits")]),a("h1",[t._v(t._s(t.count))])]):t._e(),a("v-col",{staticClass:" white--text"},[a("small",[t._v("Total")]),a("h1",[t._v(t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:t.currency}).format(t.amount)))])])],1)],1)],1)},l=[],o=(a("a9e3"),{name:"Panel",props:{title:{type:String,default:"Total"},icon:{type:String,default:"mdi-"},count:{type:Number,default:0},amount:{type:Number,default:0},color:{type:String,default:"green"},deposit:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},currency:{type:String,default:"EUR"},appendIcon:{type:String}}}),i=o,r=a("2877"),s=a("6544"),c=a.n(s),u=a("8336"),d=a("b0af"),m=a("99d9"),p=a("62ad"),f=a("132d"),v=a("0fd9"),b=a("3129"),y=a("2fa4"),h=Object(r["a"])(i,n,l,!1,null,null,null);e["a"]=h.exports;c()(h,{VBtn:u["a"],VCard:d["a"],VCardText:m["d"],VCardTitle:m["e"],VCol:p["a"],VIcon:f["a"],VRow:v["a"],VSkeletonLoader:b["a"],VSpacer:y["a"]})},"9db7":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-text-field",t._g(t._b({attrs:{value:t.dateRangeText,readonly:"","hide-details":"",clearable:""},on:{"click:clear":t.clear}},"v-text-field",t.$attrs,!1),n))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-date-picker",{attrs:{range:""},on:{input:t.input},model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}})],1)},l=[],o=(a("a15b"),{name:"date-picker",props:{value:Array},data:function(){return{menu:!1,dates:[]}},methods:{input:function(t){t.length>1&&(this.menu=!1,this.$emit("input",t))},clear:function(){this.dates=[],this.$emit("input",[])}},computed:{dateRangeText:function(){return this.dates.join(" ~ ")}},created:function(){this.value&&(this.dates=this.value)}}),i=o,r=a("2877"),s=a("6544"),c=a.n(s),u=a("2e4b"),d=a("e449"),m=a("8654"),p=Object(r["a"])(i,n,l,!1,null,null,null);e["a"]=p.exports;c()(p,{VDatePicker:u["a"],VMenu:d["a"],VTextField:m["a"]})},b1e1:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",{staticClass:"mt-2",attrs:{elevation:"1"}},[a("v-card-title",[a("v-icon",{staticClass:"mx-2"},[t._v(" mdi-file-chart ")]),a("v-toolbar-title",[t._v("Report")])],1),a("v-card-text",[t.gLoading?a("v-row",[a("v-col",{attrs:{cols:"12",sm:"7"}},[a("v-skeleton-loader",{attrs:{type:"card-heading"}})],1),a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-skeleton-loader",{attrs:{type:"card-heading"}})],1),a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-skeleton-loader",{attrs:{type:"card-heading"}})],1),a("v-col",{attrs:{cols:"12",sm:"7"}},[a("v-skeleton-loader",{attrs:{type:"card-heading"}})],1)],1):a("v-row",[a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-date-picker",{model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}})],1),a("v-col",{attrs:{cols:"12",sm:"5"}},[a("app-auto-complete",{attrs:{hideAddNew:"",outlined:"","hide-details":"",rounded:"",dense:"",label:"Department",collection:"department",itemText:"name",itemValue:"_id"},model:{value:t.department,callback:function(e){t.department=e},expression:"department"}})],1),a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-select",{attrs:{label:"Report by",outlined:"","hide-details":"",rounded:"",dense:"",items:t.byItems},model:{value:t.by,callback:function(e){t.by=e},expression:"by"}})],1),a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-auto-complete",t._g(t._b({attrs:{hideAddNew:"",outlined:"","hide-details":"",rounded:"",dense:""},model:{value:t.autocomplete.value,callback:function(e){t.$set(t.autocomplete,"value",e)},expression:"autocomplete.value"}},"app-auto-complete",t.autocomplete.bind,!1),t.autocomplete.on))],1),t.isAffiliate?a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-auto-complete",t._b({ref:"subaffiliate",attrs:{rounded:"",outlined:"",dense:"",hideAddNew:"",label:"Subaffiliate",collection:"subaffiliate",itemText:"name",itemValue:"_id"},model:{value:t.subaffiliateValue,callback:function(e){t.subaffiliateValue=e},expression:"subaffiliateValue"}},"app-auto-complete",t.subaffiliateBind,!1))],1):t._e(),a("v-col",{attrs:{cols:"12",sm:"3"}},[a("v-btn",{attrs:{large:"",rounded:"",color:"green white--text",width:"100%"},on:{click:t.submit}},[t._v("Submit")])],1)],1)],1)],1),a("app-panel",{attrs:{title:"Total",count:t.totals.count,amount:t.totals.amount}}),a("v-card",{staticClass:"my-4",attrs:{elevation:"1"}},[a("v-data-table",{staticClass:"my-5 elevation-1",attrs:{loading:t.loading,headers:t.headers,"single-expand":!0,expanded:t.expanded,"show-expand":"","item-key":"_id",items:t.items},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"loading",fn:function(){return[a("v-skeleton-loader",{staticClass:"mt-6",attrs:{height:"94",type:"list-item-three-line"}})]},proxy:!0},{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"expanded-item",fn:function(e){var n=e.headers,l=e.item;return[a("td",{staticClass:"pa-4",attrs:{colspan:n.length}},[a("v-data-table",{attrs:{headers:t.dataHeaders,items:l.child},on:{"click:row":function(e){return t.innerListClick(e,l)}},scopedSlots:t._u([{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}}],null,!0)})],1)]}}])})],1),a("v-dialog",{attrs:{"max-width":"960"},model:{value:t.dialog.value,callback:function(e){t.$set(t.dialog,"value",e)},expression:"dialog.value"}},[a("v-card",[a("v-card-title",[t._v(" "+t._s(t.dialog.title)+" "),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialog.value=!1}}},[a("v-icon",[t._v("mdi-close")])],1),a("v-card-text",[a("v-data-table",{attrs:{headers:t.dialog.headers,items:t.dialog.items},scopedSlots:t._u([{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}}])})],1)],1)],1)],1)],1)},l=[],o=(a("99af"),a("a15b"),a("b0c0"),a("96cf"),a("1da1")),i=a("5530"),r=a("2909"),s=a("2e17"),c=a("bb0b"),u=a("9db7"),d=a("1dde3"),m=a("2f62"),p=a("b9b9"),f=a.n(p),v={customer:[{text:"TP Account",align:"start",value:"customer.tpc"},{text:"Account name",align:"start",value:"customer.name"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}],affiliate:[{text:"Affiliate",align:"start",value:"affiliate.name"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}],user:[{text:"Agent",align:"start",value:"user.displayName"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}]},b={customer:[{text:"Department",value:"department.name"},{text:"Date",value:"created_on"},{text:"Amount",value:"amount"},{text:"Owner",value:"user.displayName"}],affiliate:[{text:"TP Account",align:"start",value:"customer.tpc"},{text:"Account name",value:"customer.name"},{text:"Subaffiliate",value:"subaffiliate.name"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}],user:[{text:"TP Account",align:"start",value:"customer.tpc"},{text:"Account name",align:"start",value:"customer.name"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}]},y=[{text:"Customer",value:"customer"},{text:"Affiliate",value:"affiliate"},{text:"Agent",value:"user"}],h={customer:{label:"Customer",collection:"customer",itemText:"name",itemValue:"_id"},affiliate:{label:"Affiliate",collection:"affiliate",itemText:"name",itemValue:"_id"},user:{label:"Agent",collection:"user",itemText:"displayName",itemValue:"_id",or:!1,query:{role:["!wakel","!affiliate"]}}},x={customer:function(){return{}},affiliate:function(t){return{input:function(e){t.$refs.subaffiliate.query.affiliate=e||"!",e||(t.subaffiliateValue=null)}}},user:function(){return{}}},g={name:"Report",components:{AppDatePicker:u["a"],AppAutoComplete:c["a"],appPanel:d["a"]},data:function(){return{dateformat:f.a,dates:Object(r["a"])(s["a"].currentDateRange),department:"",byItems:y,by:"customer",autocomplete:{value:"",bind:h.customer,on:x.customer()},loading:!1,gLoading:!1,headers:v.customer,dataHeaders:b.customer,items:[],expanded:[],totals:{amount:0,count:0},dialog:{value:!1,title:"",items:[],headers:b.customer},subaffiliateValue:null,subaffiliateBind:{or:!1,query:{affiliate:"!"}}}},computed:{isAffiliate:function(){return"affiliate"==this.by}},watch:{by:function(){this.autocomplete.value="",this.autocomplete.bind=h[this.by],this.autocomplete.on=x[this.by](this),this.headers=v[this.by],this.dataHeaders=b[this.by],this.items=[]}},methods:Object(i["a"])(Object(i["a"])({},Object(m["b"])({get:"api/get"})),{},{submit:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,t.items=[],t.expanded=[],e.next=5,t.get({collection:"report_new",query:{department:t.department||null,by:t.by,created_on:t.dates.join("|"),id:t.autocomplete.value||null,subaffiliate:t.subaffiliateValue||null}});case 5:return a=e.sent,e.next=8,t.get({collection:"report_new/total",query:{department:t.department||null,by:t.by,created_on:t.dates.join("|"),id:t.autocomplete.value||null,subaffiliate:t.subaffiliateValue||null}});case 8:n=e.sent,console.log(a.data),t.totals.amount=n.data[0].amount,t.totals.count=n.data[0].count,t.items=a.data,t.loading=!1;case 14:case"end":return e.stop()}}),e)})))()},innerListClick:function(t){"customer"!=this.by&&(this.dialog.value=!0,this.dialog.items=t.child,this.dialog.title="(".concat(t.customer.tpc,") ").concat(t.customer.name))}}),created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.gLoading=!0,e.next=3,t.get({collection:"department",query:{type:"rtn"}});case 3:a=e.sent,a&&200==a.status&&(t.department=a.data.docs[0]._id),t.gLoading=!1;case 6:case"end":return e.stop()}}),e)})))()}},_=g,k=a("2877"),w=a("6544"),V=a.n(w),C=a("8336"),T=a("b0af"),S=a("99d9"),A=a("62ad"),D=a("a523"),R=a("8fea"),j=a("169a"),N=a("132d"),I=a("0fd9"),O=a("b974"),$=a("3129"),L=a("2fa4"),U=a("2a7f"),P=Object(k["a"])(_,n,l,!1,null,null,null);e["default"]=P.exports;V()(P,{VBtn:C["a"],VCard:T["a"],VCardText:S["d"],VCardTitle:S["e"],VCol:A["a"],VContainer:D["a"],VDataTable:R["a"],VDialog:j["a"],VIcon:N["a"],VRow:I["a"],VSelect:O["a"],VSkeletonLoader:$["a"],VSpacer:L["a"],VToolbarTitle:U["c"]})}}]);
//# sourceMappingURL=chunk-b01faab8.5930e1ea.js.map