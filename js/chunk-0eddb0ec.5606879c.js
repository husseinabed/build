(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0eddb0ec"],{"1b5f":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-text-field",t._b({attrs:{value:t.value,autocomplete:"current-password","append-icon":t.show?"mdi-eye":"mdi-eye-off",type:t.show?"text":"password",counter:""},on:{input:function(e){return t.$emit("input",e)},"click:append":function(e){t.show=!t.show}}},"v-text-field",t.$attrs,!1))},i=[],r={name:"password",props:{value:String},data:function(){return{show:!1}}},o=r,s=a("2877"),c=a("6544"),l=a.n(c),u=a("8654"),d=Object(s["a"])(o,n,i,!1,null,null,null);e["a"]=d.exports;l()(d,{VTextField:u["a"]})},"5b8f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-col",[t.readAccess?a("v-col",{staticClass:"pa-0 ma-0"},[t.found?a("items-header",{attrs:{icon:this.icon,collection:t.collection,title:t.title,writeAccess:t.writeAccess,"has-filters":t.hasFilters},on:{query:function(e){t.options.query=e}}}):t._e(),t.found?a("v-data-table",{staticClass:"my-5 elevation-1",attrs:{loading:t.loading,headers:t.headers,items:t.items,"items-per-page":t.options.limit,"hide-default-footer":"","multi-sort":""},on:{"update:sort-by":t.sortBy,"update:sort-desc":t.sortDesc},scopedSlots:t._u([{key:"item.created_on",fn:function(e){var a=e.item;return[t._v(" "+t._s((new Intl.DateTimeFormat).format(new Date(a.created_on)))+" ")]}},t.hasAmount?{key:"item.payment_method",fn:function(e){var a=e.item;return[t._v(" "+t._s(a.payment_method.name)+" ("+t._s(a.payment_method.type)+") ")]}}:null,t.hasAmount?{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}}:null,{key:"item.active",fn:function(t){var e=t.item;return[a("v-badge",{attrs:{color:e.active?"green":"grey"}})]}},{key:"item.read",fn:function(t){var e=t.item;return[a("v-badge",{attrs:{color:e.read?"green":"grey"}})]}},t.hasAmount?{key:"body.append",fn:function(e){return[a("tr",[a("td",{staticClass:"font-weight-bold"},[t._v("Total Amount")]),a("td"),a("td",{staticClass:"font-weight-bold"},[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.items.length?e.items.map((function(t){return t.amount})).reduce((function(t,e){return t+e})):0))+" ")]),a("td",{attrs:{colspan:"5"}})])]}}:null,{key:"item.actions",fn:function(e){var n=e.item;return[t.readAccess?a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.cloneItem(n)}}},[t._v(" mdi-content-copy ")]):t._e(),t.updateAccess?a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.editItem(n)}}},[t._v(" mdi-pencil ")]):t._e(),t.deleteAccess?a("v-icon",{attrs:{small:""},on:{click:function(e){return t.deleteItem(n)}}},[t._v(" mdi-delete ")]):t._e()]}}],null,!0)}):a("v-not-found"),t.found?a("v-toolbar",{attrs:{short:"",elevation:"1"}},[a("v-pagination",{staticClass:"my-4",attrs:{length:t.totalPages},model:{value:t.options.page,callback:function(e){t.$set(t.options,"page",e)},expression:"options.page"}}),a("v-spacer"),a("v-select",{attrs:{label:"Limit",dense:"",outlined:"","hide-details":"",items:[10,20,50]},on:{input:function(e){t.options.page=1}},model:{value:t.options.limit,callback:function(e){t.$set(t.options,"limit",e)},expression:"options.limit"}})],1):t._e()],1):a("v-col",[a("v-card",{attrs:{width:"100%"}},[a("v-card-text",{staticClass:"text-center pa-12"},[a("v-icon",{attrs:{size:"70"}},[t._v("mdi-lock")]),a("h2",[t._v("Access Denied")]),a("p",[t._v(" you dont have the right to view this content ")])],1)],1)],1)],1)},i=[],r=(a("4de4"),a("c975"),a("d81d"),a("96cf"),a("1da1")),o=a("5530"),s=a("2f62"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-toolbar",{attrs:{elevation:"1"}},[a("h2",{staticClass:"mb-3"},[a("v-icon",{attrs:{size:"30"}},[t._v(" "+t._s(this.icon)+" ")]),t._v(" "+t._s(this.title))],1),a("v-spacer"),t.writeAccess?a("v-btn",{attrs:{color:"success"},on:{click:function(e){return t.$router.push("/"+t.$route.params.collection+"/new")}}},[a("v-icon",[t._v("mdi-plus")]),t._v(" New ")],1):t._e(),t.hasFilters?a("v-btn",{staticClass:"ml-3",class:{"grey ":t.openPanel,"white--text":t.openPanel,"blue--text":t.filtersHasValues},attrs:{icon:""},on:{click:function(e){t.openPanel=!t.openPanel}}},[a("v-icon",[t._v("mdi-filter")])],1):t._e()],1),t.openPanel&&t.hasFilters?a("v-toolbar",{staticClass:"py-4",attrs:{elevation:"1",height:"70"}},t._l(t.collection.filters,(function(e,n){return a("v-col",{key:n},[a(t.inputs[e.input],t._g(t._b({tag:"component",model:{value:t.data[e.name].value,callback:function(a){t.$set(t.data[e.name],"value",a)},expression:"data[field.name].value"}},"component",e.bind,!1),e.on))],1)})),1):t._e()],1)},l=[],u=(a("4160"),a("b0c0"),a("b64b"),a("07ac"),a("159b"),a("8654")),d=a("b974"),m=a("b73d"),f=a("bb0b"),h=a("e94a"),p={name:"ItemsHeader",props:{writeAccess:Boolean,hasFilters:Boolean,collection:Object,icon:String,title:String},data:function(){return{openPanel:!1,data:{},inputs:{text:u["a"],select:d["a"],switch:m["a"],date:h["a"],autocomplete:f["a"]}}},watch:{data:{handler:"emitPreparedData",deep:!0}},computed:{filtersHasValues:function(){return Object.values(this.data).filter((function(t){return Boolean(t.value)})).length}},methods:{emitPreparedData:function(){var t=this,e={};Object.keys(this.data).forEach((function(a){t.data[a].value&&(e[a]=t.data[a])})),this.$emit("query",e)},generateDataInputs:function(){var t={};this.collection.filters.forEach((function(e){t[e.name]={type:e.input,value:""}})),this.data=t}},created:function(){this.generateDataInputs()}},v=p,b=a("2877"),g=a("6544"),w=a.n(g),_=a("8336"),y=a("62ad"),x=a("132d"),k=a("2fa4"),$=a("71d9"),V=Object(b["a"])(v,c,l,!1,null,null,null),I=V.exports;w()(V,{VBtn:_["a"],VCol:y["a"],VIcon:x["a"],VSpacer:k["a"],VToolbar:$["a"]});var A=a("fb57"),C={components:{ItemsHeader:I},data:function(){return{options:{query:{},sortBy:[],sortDesc:[],page:1,limit:10},totalPages:1,collection:null,filterOn:!1,loading:!1,title:"",icon:"",found:!0,headers:[],items:[]}},computed:{hasFilters:function(){return!!this.collection&&(this.collection.filters&&this.collection.filters.length>-1)},filters:function(){return this.hasFilters?this.collection.filters:[]},access:function(){var t=this;return this.$store.state.auth.user.rights?this.$store.state.auth.user.rights.filter((function(e){return e.value==t.$route.params.collection})):[]},writeAccess:function(){return this.access.length>0&&this.access[0].write},readAccess:function(){return this.access.length>0&&this.access[0].read},updateAccess:function(){return this.access.length>0&&this.access[0].update},deleteAccess:function(){return this.access.length>0&&this.access[0].delete},hasAmount:function(){var t=["sales","retention"];return-1!==t.indexOf(this.$route.params.collection)}},watch:{$route:{handler:"updateComponent",immediate:!0},options:{handler:"fetch",immediate:!0,deep:!0}},methods:Object(o["a"])(Object(o["a"])({sortBy:function(t){this.options.sortBy=t},sortDesc:function(t){this.options.sortDesc=t.map((function(t){return t?-1:1}))}},Object(s["b"])({get:"api/get",remove:"api/remove"})),{},{fetch:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("Fetching"),t.loading=!0,e.next=4,t.get({collection:t.$route.params.collection,query:t.options});case 4:a=e.sent,a&&200===a.status&&(t.items=a.data.docs,t.totalPages=a.data.totalPages),t.loading=!1;case 7:case"end":return e.stop()}}),e)})))()},editItem:function(t){this.$router.push("/"+this.$route.params.collection+"/"+t._id)},cloneItem:function(t){this.$router.push("/"+this.$route.params.collection+"/new?clone="+t._id)},deleteItem:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$confirm("Are you sure do you want to delete this item ?",{title:"Warning"});case 2:if(n=a.sent,!n){a.next=9;break}return e.loading=!0,a.next=7,e.remove({collection:e.$route.params.collection,id:t._id});case 7:i=a.sent,200===i.status&&(e.fetch(),e.loading=!1,e.$store.commit("success","Item deleted successfuly"));case 9:case"end":return a.stop()}}),a)})))()},updateComponent:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=A["default"].get(t.$route.params.collection),t.collection=a,a?(t.title=a.title,t.icon=a.icon,t.headers=a.table):t.found=!1;case 3:case"end":return e.stop()}}),e)})))()}})},O=C,S=(a("a0fe"),a("4ca6")),j=a("b0af"),T=a("99d9"),R=a("8fea"),D=a("891e"),P=Object(b["a"])(O,n,i,!1,null,"0cd1970f",null);e["default"]=P.exports;w()(P,{VBadge:S["a"],VCard:j["a"],VCardText:T["d"],VCol:y["a"],VDataTable:R["a"],VIcon:x["a"],VPagination:D["a"],VSelect:d["a"],VSpacer:k["a"],VToolbar:$["a"]})},9320:function(t,e,a){},9894:function(t,e,a){"use strict";var n=a("9320"),i=a.n(n);i.a},a0fe:function(t,e,a){"use strict";var n=a("c6b0"),i=a.n(n);i.a},b012:function(t,e){function a(t,e,a){var n,i,r,o,s;function c(){var l=Date.now()-o;l<e&&l>=0?n=setTimeout(c,e-l):(n=null,a||(s=t.apply(r,i),r=i=null))}null==e&&(e=100);var l=function(){r=this,i=arguments,o=Date.now();var l=a&&!n;return n||(n=setTimeout(c,e)),l&&(s=t.apply(r,i),r=i=null),s};return l.clear=function(){n&&(clearTimeout(n),n=null)},l.flush=function(){n&&(s=t.apply(r,i),r=i=null,clearTimeout(n),n=null)},l}a.debounce=a,t.exports=a},bb0b:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"100%"}},[a("v-autocomplete",t._b({attrs:{value:t.value,"search-input":t.search,items:t.dataItems,loading:t.loading,clearable:"","return-object":""},on:{"update:searchInput":function(e){t.search=e},"update:search-input":function(e){t.search=e},input:t.emit},scopedSlots:t._u([!t.hideAddNew&&t.writeAccess?{key:"prepend-item",fn:function(){return[a("v-list-item",{on:{click:t.addNew}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"green--text"},[a("v-icon",{attrs:{color:"green"}},[t._v("mdi-plus")]),t._v(" Add New")],1)],1)],1)]},proxy:!0}:null],null,!0)},"v-autocomplete",t.$attrs,!1)),a("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("app-item",{attrs:{"collection-name":t.collection},on:{close:function(e){t.dialog=!1},save:t.newSave}})],1)],1)],1)},i=[],r=(a("4de4"),a("96cf"),a("1da1")),o=a("5530"),s=a("b012"),c=a.n(s),l=a("2f62"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-col",{staticClass:"pa-0"},[a("v-toolbar",{attrs:{dark:"",color:"primary"}},[a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){return t.$emit("close")}}},[a("v-icon",[t._v("mdi-close")])],1),a("v-toolbar-title",[t._v(t._s(t.title))]),a("v-spacer"),t.writeAccess?a("v-toolbar-items",[a("v-btn",{attrs:{dark:"",text:""},on:{click:t.validate}},[t._v("Save")])],1):t._e()],1),t.found?a("v-card",{attrs:{flat:""}},[a("v-card-title",[t._v(" "+t._s(t.title)+" ")]),a("v-card-text",[t.tabs.length>1?a("v-tabs",{attrs:{"center-active":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.tabs,(function(e,n){return a("v-tab",{key:n},[t._v(" "+t._s(e)+" ")])})),1):t._e(),a("v-form",{ref:"form"},[t.loading?t._e():a("v-tabs-items",{attrs:{"center-active":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.tabs,(function(e,n){return a("v-tab-item",{key:n,staticClass:"px-5"},t._l(t.fields,(function(e,n){return a("v-row",{key:n},[a(t.inputs[e.input],t._g(t._b({ref:t.$route.params.collection+"_"+e.name,refInFor:!0,tag:"component",model:{value:t.data[e.name],callback:function(a){t.$set(t.data,e.name,a)},expression:"data[field.name]"}},"component",e.bind,!1),e.on))],1)})),1)})),1)],1)],1)],1):a("v-not-found")],1)},d=[],m=(a("4160"),a("d81d"),a("b0c0"),a("ac1f"),a("1276"),a("159b"),a("8654")),f=a("b974"),h=a("b73d"),p=a("1b5f"),v=a("e94a"),b=a("d6a0"),g=a("fb57"),w={name:"AppItem",props:{collectionName:String},data:function(){return{loading:!1,collection:null,tab:0,form:null,found:!0,title:"",data:{},inputs:{text:m["a"],select:f["a"],switch:h["a"],date:v["a"],autocomplete:M,password:p["a"],rights:b["a"]}}},computed:{tabs:function(){return this.form?this.form.map((function(t){return t.label})):[]},fields:function(){return this.form?this.form[this.tab].fields:[]},access:function(){var t=this;return this.$store.state.auth.user.rights?this.$store.state.auth.user.rights.filter((function(e){return e.value==t.collection})):[]},writeAccess:function(){return this.access.length>0&&this.access[0].write}},methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])({save:"api/save",success:"success"})),{},{generateDataInputs:function(t,e){var a={},n={};t.forEach((function(t){t.fields.forEach((function(t){if("password"==t.name)return a[t.name]="";"date"==t.input&&e[t.name]&&(e[t.name]=e[t.name].split("T")[0]),a[t.name]=e[t.name]?e[t.name]:t.default||"","date"==t.input&&(n[t.name]=!1)}))})),this.data=a,this.menu=n},validate:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.data,n=t.collection,i=t.title,!t.$refs.form.validate()){e.next=12;break}return e.next=4,t.save({collection:n,data:a});case 4:if(r=e.sent,console.log(r),!r){e.next=10;break}return e.next=9,t.$store.commit("success",i+" saved successfuly");case 9:t.$emit("save",r.data);case 10:e.next=13;break;case 12:t.$store.commit("error","form not valid");case 13:case"end":return e.stop()}}),e)})))()}}),mounted:function(){window.$form=this},destroyed:function(){window.$form=null},created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=g["default"].get(t.collectionName),t.collection=t.collectionName,a?(t.title=a.title,t.form=a.form,n={},t.generateDataInputs(t.form,n)):t.found=!1;case 3:case"end":return e.stop()}}),e)})))()}},_=w,y=(a("9894"),a("2877")),x=a("6544"),k=a.n(x),$=a("8336"),V=a("b0af"),I=a("99d9"),A=a("62ad"),C=a("4bd4"),O=a("132d"),S=a("0fd9"),j=a("2fa4"),T=a("71a3"),R=a("c671"),D=a("fe57"),P=a("aac8"),F=a("71d9"),B=a("2a7f"),E=Object(y["a"])(_,u,d,!1,null,null,null),N=E.exports;k()(E,{VBtn:$["a"],VCard:V["a"],VCardText:I["d"],VCardTitle:I["e"],VCol:A["a"],VForm:C["a"],VIcon:O["a"],VRow:S["a"],VSpacer:j["a"],VTab:T["a"],VTabItem:R["a"],VTabs:D["a"],VTabsItems:P["a"],VToolbar:F["a"],VToolbarItems:B["b"],VToolbarTitle:B["c"]});var U={name:"autocomplete",components:{AppItem:N},props:{value:String,hideAddNew:Boolean,collection:{type:String}},data:function(){return{search:"",dataItems:[],loading:!1,dialog:!1}},computed:{access:function(){var t=this;return this.$store.state.auth.user.rights?this.$store.state.auth.user.rights.filter((function(e){return e.value==t.collection})):[]},writeAccess:function(){return this.access.length>0&&this.access[0].write}},methods:Object(o["a"])(Object(o["a"])({emit:function(t){this.$emit("input",t?t[this.$attrs.itemValue]:"")},addNew:function(){this.dialog=!0},newSave:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.dialog=!1,console.log(e.dataItems),e.dataItems.push(t),e.$emit("input",t[e.$attrs.itemValue]);case 4:case"end":return a.stop()}}),a)})))()}},Object(l["b"])({get:"api/get"})),{},{makeSearch:function(t,e){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.loading=!0,n.next=3,a.get({collection:e,search:{name:t}});case 3:i=n.sent,a.dataItems=i.data.docs,a.loading=!1;case 6:case"end":return n.stop()}}),n)})))()}}),watch:{search:function(t){this.collection&&c()(this.makeSearch,500)(t,this.collection)}},created:function(){this.collection?this.makeSearch("",this.collection):this.$attrs.items&&(this.dataItems=this.$attrs.items)}},q=U,H=a("c6a6"),L=a("169a"),z=a("da13"),J=a("5d23"),W=Object(y["a"])(q,n,i,!1,null,null,null),M=e["a"]=W.exports;k()(W,{VAutocomplete:H["a"],VCard:V["a"],VDialog:L["a"],VIcon:O["a"],VListItem:z["a"],VListItemContent:J["g"],VListItemTitle:J["k"]})},c6b0:function(t,e,a){},d6a0:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{flat:"",width:"100%"}},[a("v-card-text",{staticClass:"text-center"},[a("v-divider"),a("h2",{staticClass:"my-5"},[t._v(t._s(t.label))]),a("v-divider"),a("v-data-table",{attrs:{headers:t.headers,items:t.data,"hide-default-footer":""},scopedSlots:t._u([{key:"item.read",fn:function(e){var n=e.item;return[a("v-switch",{on:{change:function(e){return t.handelReadRight(e,n)}},model:{value:n.read,callback:function(e){t.$set(n,"read",e)},expression:"item.read"}})]}},{key:"item.write",fn:function(e){var n=e.item;return[a("v-switch",{model:{value:n.write,callback:function(e){t.$set(n,"write",e)},expression:"item.write"}})]}},{key:"item.update",fn:function(e){var n=e.item;return[a("v-switch",{model:{value:n.update,callback:function(e){t.$set(n,"update",e)},expression:"item.update"}})]}},{key:"item.delete",fn:function(e){var n=e.item;return[a("v-switch",{model:{value:n.delete,callback:function(e){t.$set(n,"delete",e)},expression:"item.delete"}})]}}])}),t._v("> ")],1)],1)},i=[],r=(a("4de4"),a("4160"),a("159b"),{name:"Rights",props:{label:String,value:{type:Array,default:function(){return[]}}},data:function(){return{headers:[{text:"Section",value:"section",width:"50%"},{text:"Read",value:"read"},{text:"Write",value:"write"},{text:"Update",value:"update"},{text:"Delete",value:"delete"}],data:[{section:"Sales",value:"sale",read:!0,write:!0,update:!0,delete:!0},{section:"Retention",value:"retention",read:!0,write:!0,update:!0,delete:!0},{section:"Payment Methods",value:"payment_method",read:!0,write:!0,update:!0,delete:!0},{section:"Affiliate",value:"affiliate",read:!0,write:!0,update:!0,delete:!0},{section:"Users",value:"user",read:!0,write:!0,update:!0,delete:!0},{section:"Roles",value:"role",read:!0,write:!0,update:!0,delete:!0}]}},methods:{handelReadRight:function(t,e){t||(e.write=!1,e.update=!1,e.delete=!1)}},watch:{data:{deep:!0,handler:function(t){this.$emit("input",t)}}},mounted:function(){var t=this;this.value.length<1&&this.$emit("input",this.data),console.log(this.value),this.value.forEach((function(e){var a=t.data.filter((function(t){return t.value==e.value}));a[0]&&Object.assign(a[0],e)}))}}),o=r,s=a("2877"),c=a("6544"),l=a.n(c),u=a("b0af"),d=a("99d9"),m=a("8fea"),f=a("ce7e"),h=a("b73d"),p=Object(s["a"])(o,n,i,!1,null,null,null);e["a"]=p.exports;l()(p,{VCard:u["a"],VCardText:d["d"],VDataTable:m["a"],VDivider:f["a"],VSwitch:h["a"]})}}]);
//# sourceMappingURL=chunk-0eddb0ec.5606879c.js.map