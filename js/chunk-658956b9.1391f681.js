(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-658956b9"],{"762c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",[a("v-card-text",{staticClass:"px-6"},[a("v-form",{ref:"form"},[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-select",{attrs:{required:"",rules:[function(e){return!!e||"this field is required"}],rounded:"",outlined:"",dense:"",label:"Report",items:e.types,"item-text":"text","item-value":"value"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-datepicker",{model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1),a("v-col",{attrs:{cols:"12",sm:"9"}},[a("app-autocomplete",e._b({attrs:{rounded:"",outlined:"",dense:""},model:{value:e.autocomplete.value,callback:function(t){e.$set(e.autocomplete,"value",t)},expression:"autocomplete.value"}},"app-autocomplete",e.autocomplete.bind,!1))],1),a("v-col",{attrs:{cols:"12",sm:"3"}},[a("v-btn",{attrs:{large:"",rounded:"",color:"green white--text",width:"100%"},on:{click:e.submit}},[e._v("Submit")])],1)],1)],1)],1)],1),a("v-data-table",{staticClass:"my-5 elevation-1",attrs:{headers:e.headers,"single-expand":e.singleExpand,expanded:e.expanded,"show-expand":"","item-key":"_id._id",items:e.items},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"expanded-item",fn:function(t){var n=t.headers,r=t.item;return[a("td",{staticClass:"pa-4",attrs:{colspan:n.length}},[a("v-data-table",{attrs:{headers:e.dataHeaders,items:e.dataItems},on:{"click:row":function(t){return e.innerListClick(t,r)}},scopedSlots:e._u([{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s((new Intl.DateTimeFormat).format(new Date(a.created_on)))+" ")]}}],null,!0)})],1)]}}])}),a("v-dialog",{attrs:{scrollable:"","max-width":"960px"},model:{value:e.dialog.value,callback:function(t){e.$set(e.dialog,"value",t)},expression:"dialog.value"}},[a("v-card",[a("v-card-title",{domProps:{innerHTML:e._s(e.dialog.title)}}),a("v-divider"),a("v-card-text",{staticStyle:{height:"300px"}},[a("v-data-table",{attrs:{headers:e.dialog.headers,items:e.dialog.items},scopedSlots:e._u([{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s((new Intl.DateTimeFormat).format(new Date(a.created_on)))+" ")]}}])})],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog.value=!1}}},[e._v("Close")])],1)],1)],1)],1)},r=[],i=(a("99af"),a("a15b"),a("b0c0"),a("5530")),o=(a("96cf"),a("1da1")),c=a("bb0b"),l=a("9db7"),s=a("2f62"),u=[{text:"TP Account",align:"start",value:"_id.tpc"},{text:"Account name",align:"start",value:"_id.name"},{text:"Affiliate",value:"_id.affiliate.name"},{text:"Deposits",value:"count",width:"10%"},{text:"Total",value:"amount"}],d=[{text:"Affiliate",align:"start",value:"_id.name"},{text:"Deposits",value:"count",width:"10%"},{text:"Total",value:"amount"}],m=[{text:"Agent",align:"start",value:"_id.displayName"},{text:"Deposits",value:"count",width:"10%"},{text:"Total",value:"amount"}],p=[{text:"Department",value:"department.name"},{text:"Date",value:"created_on"},{text:"Amount",value:"amount"},{text:"Payment Method",value:"payment_method.name"}],v=[{text:"TP Account",align:"start",value:"_id.tpc"},{text:"Account name",align:"start",value:"_id.name"},{text:"Deposits",value:"count",width:"10%"},{text:"Amount",value:"amount"}],f=[{text:"TP Account",align:"start",value:"_id.tpc"},{text:"Account name",align:"start",value:"_id.name"},{text:"Affilaite",align:"start",value:"_id.affiliate.name"},{text:"Deposits",value:"count",width:"10%"},{text:"Amount",value:"amount"}];function b(e,t){var a=""+e;while(a.length<t)a="0"+a;return a}var x={name:"Report",components:{"app-autocomplete":c["a"],"app-datepicker":l["a"]},data:function(){var e=new Date;e.setHours(0,0,0,0);var t=["".concat(e.getFullYear(),"-").concat(b(e.getMonth()+1,2),"-01"),"".concat(e.getFullYear(),"-").concat(b(e.getMonth()+1,2),"-").concat(b(e.getDate(),2))];return{dialog:{value:!1,headers:p,items:[],title:""},dataItems:[],dataHeaders:p,expanded:[],singleExpand:!0,items:[],headers:u,types:[{text:"By Lead",value:"lead"},{text:"By Affiliate",value:"affiliate"},{text:"By Agent",value:"agent"}],type:"lead",autocomplete:{value:"",bind:{collection:"customer",itemValue:"_id",itemText:"name",hideAddNew:!0,label:"Select a lead",searchFields:["name","tpc"]}},dates:t}},watch:{expanded:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,r,o,c,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.length){a.next=23;break}a.t0=t.type,a.next="lead"===a.t0?4:"affiliate"===a.t0?9:"agent"===a.t0?16:23;break;case 4:return a.next=6,t.get({collection:"deposit",query:{created_on:t.dates.join("|"),customer:e[0]._id._id,sortBy:["created_on"],sortDesc:[!0]}});case 6:return n=a.sent,t.dataItems=n.data.docs,a.abrupt("break",23);case 9:return r={created_on:t.dates.join("|"),"affiliate._id":e[0]._id._id},a.next=12,t.get({collection:"report/affiliate",query:Object(i["a"])(Object(i["a"])({groupBy:"customer._id"},r),{},{meta:{collection:"customer"},sortBy:["customer.tpc","created_on"],sortDesc:[1,1]})});case 12:return o=a.sent,console.log(o),t.dataItems=o.data,a.abrupt("break",23);case 16:return c={created_on:t.dates.join("|"),user:e[0]._id._id},a.next=19,t.get({collection:"report/agent",query:Object(i["a"])(Object(i["a"])({groupBy:"customer._id"},c),{},{meta:{collection:"customer"},sortBy:["customer.affiliate.name","created_on"],sortDesc:[1,1]})});case 19:return l=a.sent,console.log(l),t.dataItems=l.data,a.abrupt("break",23);case 23:case"end":return a.stop()}}),a)})))()},type:function(e){switch(this.items=[],this.autocomplete.value="",e){case"lead":this.autocomplete.bind.collection="customer",this.autocomplete.bind.itemText="name",this.autocomplete.bind.label="Select a lead",this.headers=u,this.dataHeaders=p;break;case"affiliate":this.autocomplete.bind.collection="affiliate",this.autocomplete.bind.itemText="name",this.autocomplete.bind.label="Select an affiliate",this.headers=d,this.dataHeaders=v;break;case"agent":this.autocomplete.bind.collection="user",this.autocomplete.bind.itemText="displayName",this.autocomplete.bind.label="Select an agent",this.headers=m,this.dataHeaders=f;break}}},methods:Object(i["a"])(Object(i["a"])({},Object(s["b"])({get:"api/get"})),{},{innerListClick:function(e,t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,i,o,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("affiliate"!=a.type){n.next=8;break}return r=e._id._id,n.next=4,a.get({collection:"deposit",query:{created_on:a.dates.join("|"),customer:r,limit:1e3,sortBy:["created_on"],sortDesc:[!0]}});case 4:i=n.sent,a.dialog.value=!0,a.dialog.items=i.data.docs,a.dialog.title="( <small>".concat(e._id.tpc,"</small> ) ").concat(e._id.name);case 8:if("agent"!=a.type){n.next=16;break}return o=e._id._id,n.next=12,a.get({collection:"deposit",query:{created_on:a.dates.join("|"),customer:o,user:t._id._id,limit:1e3,sortBy:["created_on"],sortDesc:[!0]}});case 12:c=n.sent,a.dialog.value=!0,a.dialog.items=c.data.docs,a.dialog.title="( <small>".concat(e._id.tpc,"</small> ) ").concat(e._id.name);case 16:case"end":return n.stop()}}),n)})))()},submit:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=20;break}a=e.autocomplete.bind.collection,n={created_on:e.dates.join("|")},t.t0=a,t.next="affiliate"===t.t0?6:"customer"===t.t0?8:10;break;case 6:return r="customer."+a,t.abrupt("break",12);case 8:return r="customer._id",t.abrupt("break",12);case 10:return r=a,t.abrupt("break",12);case 12:return e.autocomplete.value&&(n[r]=e.autocomplete.value),t.next=15,e.get({collection:"report",query:Object(i["a"])(Object(i["a"])({groupBy:"$"+r,meta:{collection:a}},n),{},{sortBy:["_id.tpc"],sortDesc:[1]})});case 15:o=t.sent,e.items=o.data,console.log(o.data),t.next=21;break;case 20:e.$store.commit("error","form not valid");case 21:case"end":return t.stop()}}),t)})))()}})},h=x,_=a("2877"),g=a("6544"),y=a.n(g),k=a("8336"),w=a("b0af"),D=a("99d9"),j=a("62ad"),T=a("a523"),A=a("8fea"),S=a("169a"),V=a("ce7e"),O=a("4bd4"),B=a("0fd9"),C=a("b974"),R=Object(_["a"])(h,n,r,!1,null,null,null);t["default"]=R.exports;y()(R,{VBtn:k["a"],VCard:w["a"],VCardActions:D["b"],VCardText:D["d"],VCardTitle:D["e"],VCol:j["a"],VContainer:T["a"],VDataTable:A["a"],VDialog:S["a"],VDivider:V["a"],VForm:O["a"],VRow:B["a"],VSelect:C["a"]})},"9db7":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,r=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{rounded:"",outlined:"",dense:"",value:e.dateRangeText,label:"Date range",readonly:"",clearable:""},on:{"click:clear":e.clear}},"v-text-field",r,!1),n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-date-picker",{attrs:{range:""},on:{input:e.input},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1)},r=[],i=(a("a15b"),{name:"date-picker",props:{value:Array},data:function(){return{menu:!1,dates:[]}},methods:{input:function(e){e.length>1&&(this.menu=!1,this.$emit("input",e))},clear:function(){this.dates=[],this.$emit("input",[])}},computed:{dateRangeText:function(){return this.dates.join(" ~ ")}},created:function(){this.value&&(this.dates=this.value)}}),o=i,c=a("2877"),l=a("6544"),s=a.n(l),u=a("2e4b"),d=a("e449"),m=a("8654"),p=Object(c["a"])(o,n,r,!1,null,null,null);t["a"]=p.exports;s()(p,{VDatePicker:u["a"],VMenu:d["a"],VTextField:m["a"]})}}]);
//# sourceMappingURL=chunk-658956b9.1391f681.js.map