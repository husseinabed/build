(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ec6eace"],{"762c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[e._v(" "+e._s(e.isAffiliate)+" "),a("v-card",[a("v-card-title",[a("v-icon",{staticClass:"mx-2"},[e._v("mdi-chart-line")]),e._v(" Upsales Sales")],1),a("v-card-text",{staticClass:"px-6"},[a("v-form",{ref:"form"},[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-select",{attrs:{required:"",rules:[function(e){return!!e||"this field is required"}],rounded:"",outlined:"",dense:"",label:"Report",items:e.types,"item-text":"text","item-value":"value"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-datepicker",{model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1),a("v-col",{attrs:{cols:"12",sm:e.isAffiliate?5:9}},[a("app-autocomplete",e._b({attrs:{rounded:"",outlined:"",dense:""},on:{input:e.setTag},model:{value:e.autocomplete.value,callback:function(t){e.$set(e.autocomplete,"value",t)},expression:"autocomplete.value"}},"app-autocomplete",e.autocomplete.bind,!1))],1),e.isAffiliate?a("v-col",{attrs:{cols:"12",sm:4}},[a("app-autocomplete",e._b({ref:"subaffiliate",attrs:{rounded:"",outlined:"",dense:"",hideAddNew:"",label:"Subaffiliate",collection:"subaffiliate",itemText:"name",itemValue:"_id"},model:{value:e.subaffiliateValue,callback:function(t){e.subaffiliateValue=t},expression:"subaffiliateValue"}},"app-autocomplete",e.subaffiliateBind,!1))],1):e._e(),a("v-col",{attrs:{cols:"12",sm:"3"}},[a("v-btn",{attrs:{large:"",rounded:"",color:"green white--text",width:"100%"},on:{click:e.submit}},[e._v("Submit")])],1)],1)],1)],1)],1),a("v-data-table",{staticClass:"my-5 elevation-1",attrs:{loading:e.loading,headers:e.headers,"single-expand":e.singleExpand,expanded:e.expanded,"show-expand":"","item-key":"_id",items:e.items},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"loading",fn:function(){return[a("v-skeleton-loader",{staticClass:"mt-6",attrs:{height:"94",type:"list-item-three-line"}})]},proxy:!0},{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.total.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.total.amount))+" ")]}},{key:"item.count",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.child.length)+" ")]}},{key:"item.deposits",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.getDeposits(a.child))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}},{key:"expanded-item",fn:function(t){var n=t.headers,i=t.item;return[a("td",{staticClass:"pa-4",attrs:{colspan:n.length}},[a("v-data-table",{attrs:{headers:e.dataHeaders,items:i.child},on:{"click:row":function(t){return e.innerListClick(t,i)}},scopedSlots:e._u([{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.ftd.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.ftd.amount))+" ")]}},{key:"item.total.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.total?a.total.amount:0))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}},{key:"item.ftd.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.dateformat(new Date(a.ftd.created_on),"yyyy-mm-dd"))+" ")]}},{key:"item.count",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.child.length)+" ")]}}],null,!0)})],1)]}}])}),a("v-dialog",{attrs:{scrollable:"","max-width":"960px"},model:{value:e.dialog.value,callback:function(t){e.$set(e.dialog,"value",t)},expression:"dialog.value"}},[a("v-card",[a("v-card-title",{domProps:{innerHTML:e._s(e.dialog.title)}}),a("v-divider"),a("v-card-text",{staticStyle:{height:"300px"}},[a("v-data-table",{attrs:{headers:e.dialog.headers,items:e.dialog.items},scopedSlots:e._u([{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}}])})],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog.value=!1}}},[e._v("Close")])],1)],1)],1)],1)},i=[],l=(a("99af"),a("a15b"),a("d81d"),a("13d5"),a("b0c0"),a("96cf"),a("1da1")),r=a("5530"),o=a("bb0b"),s=a("9db7"),u=a("2f62"),c=a("b9b9"),d=a.n(c),m=[{text:"TP Account",align:"start",value:"customer.tpc",width:"10%"},{text:"Account name",align:"start",value:"customer.name"},{text:"Owner conversion",value:"user.displayName"},{text:"FTD",value:"amount"},{text:"Deposits",value:"count"},{text:"Total",value:"total.amount"},{text:"Date",value:"created_on"}],f=[{text:"Affiliate",align:"start",value:"name"},{text:"FTDs",value:"count"}],v=[{text:"Agent",align:"start",value:"displayName"},{text:"FTD",value:"child.length"}],p=[{text:"Date",value:"created_on"},{text:"Amount",value:"amount"},{text:"Owner",value:"user.displayName"}],h=[{text:"TP Account",align:"start",value:"customer.tpc",width:"10%"},{text:"Account name",align:"start",value:"customer.name"},{text:"Subaffiliate",align:"start",value:"subaffiliate.name"},{text:"Owner conversion",value:"user.displayName"},{text:"FTD",value:"amount"},{text:"Deposits",value:"count"},{text:"Total",value:"total.amount"},{text:"Date",value:"created_on"}],b=[{text:"TP Account",align:"start",value:"tpc"},{text:"Account name",align:"start",value:"name"},{text:"Owner conversion",value:"ftd.user.displayName"},{text:"FTD",value:"ftd.amount"},{text:"FTD Date",value:"ftd.created_on"},{text:"Deposits",value:"child.length"},{text:"Owner Total",value:"total.amount"}];function y(e,t){var a=""+e;while(a.length<t)a="0"+a;return a}var x={name:"Report",components:{"app-autocomplete":o["a"],"app-datepicker":s["a"]},data:function(){var e=new Date;e.setHours(0,0,0,0);var t=["".concat(e.getFullYear(),"-").concat(y(e.getMonth()+1,2),"-01"),"".concat(e.getFullYear(),"-").concat(y(e.getMonth()+1,2),"-").concat(y(e.getDate(),2))];return{loading:!1,dateformat:d.a,dialog:{value:!1,headers:p,items:[],title:""},dataItems:[],dataHeaders:p,expanded:[],singleExpand:!0,items:[],headers:m,types:[{text:"By Lead",value:"lead"},{text:"By Affiliate",value:"affiliate"},{text:"By Agent",value:"agent"}],type:"lead",autocomplete:{value:"",bind:{collection:"customer",itemValue:"_id",itemText:"name",hideAddNew:!0,label:"Select a lead",searchFields:["name","tpc"]}},subaffiliateValue:null,subaffiliateBind:{or:!1,query:{affiliate:"!"}},dates:t}},watch:{isAffiliate:function(e){e||(this.subaffiliateValue=null)},type:function(e){switch(this.items=[],this.autocomplete.value="",e){case"lead":this.autocomplete.bind.collection="customer",this.autocomplete.bind.itemText="name",this.autocomplete.bind.label="Select a lead",this.autocomplete.bind.searchFields=["name","tpc"],delete this.autocomplete.bind.or,delete this.autocomplete.bind.query,this.headers=m,this.dataHeaders=p,this.items=[];break;case"affiliate":this.autocomplete.bind.collection="affiliate",this.autocomplete.bind.itemText="name",this.autocomplete.bind.label="Select an affiliate",delete this.autocomplete.bind.searchFields,delete this.autocomplete.bind.or,delete this.autocomplete.bind.query,this.headers=f,this.dataHeaders=h,this.items=[];break;case"agent":this.autocomplete.bind.collection="user",this.autocomplete.bind.itemText="displayName",this.autocomplete.bind.label="Select an agent",delete this.autocomplete.bind.searchFields,this.autocomplete.bind.or=!1,this.autocomplete.bind.query={role:["!wakel","!affiliate"]},this.headers=v,this.dataHeaders=b,this.items=[];break}}},computed:{isAffiliate:function(){return"affiliate"==this.type}},methods:Object(r["a"])(Object(r["a"])({},Object(u["b"])({get:"api/get"})),{},{getDeposits:function(e){var t=e.map((function(e){return e.child.length}));return t.length?t.reduce((function(e,t){return e+t})):0},innerListClick:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:"affiliate"==t.type&&(t.dialog.value=!0,t.dialog.items=e.child,t.dialog.title="( <small>".concat(e.customer.tpc,"</small> ) ").concat(e.customer.name)),"agent"==t.type&&(t.dialog.value=!0,t.dialog.items=e.child,t.dialog.title="( <small>".concat(e.tpc,"</small> ) ").concat(e.name));case 2:case"end":return a.stop()}}),a)})))()},setTag:function(e){this.isAffiliate&&(this.$refs.subaffiliate.query.affiliate=e||"!",e||(this.subaffiliateValue=null))},submit:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=18;break}t.t0=e.type,t.next="lead"===t.t0?4:"affiliate"===t.t0?6:"agent"===t.t0?8:10;break;case 4:return a="report",t.abrupt("break",10);case 6:return a="report/affiliate",t.abrupt("break",10);case 8:return a="report/agent",t.abrupt("break",10);case 10:return e.loading=!0,t.next=13,e.get({collection:a,query:{created_on:e.dates.join("|"),id:e.autocomplete.value||null,subaffiliate:e.subaffiliateValue}});case 13:n=t.sent,n&&(e.items=n.data),e.loading=!1,t.next=19;break;case 18:e.$store.commit("error","form not valid");case 19:case"end":return t.stop()}}),t)})))()}})},g=x,_=a("2877"),k=a("6544"),w=a.n(k),D=a("8336"),S=a("b0af"),V=a("99d9"),T=a("62ad"),A=a("a523"),F=a("8fea"),C=a("169a"),N=a("ce7e"),U=a("4bd4"),O=a("132d"),$=a("0fd9"),j=a("b974"),R=a("3129"),q=Object(_["a"])(g,n,i,!1,null,null,null);t["default"]=q.exports;w()(q,{VBtn:D["a"],VCard:S["a"],VCardActions:V["b"],VCardText:V["d"],VCardTitle:V["e"],VCol:T["a"],VContainer:A["a"],VDataTable:F["a"],VDialog:C["a"],VDivider:N["a"],VForm:U["a"],VIcon:O["a"],VRow:$["a"],VSelect:j["a"],VSkeletonLoader:R["a"]})},"9db7":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-text-field",e._g(e._b({attrs:{value:e.dateRangeText,readonly:"","hide-details":"",clearable:""},on:{"click:clear":e.clear}},"v-text-field",e.$attrs,!1),n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-date-picker",{attrs:{range:""},on:{input:e.input},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1)},i=[],l=(a("a15b"),{name:"date-picker",props:{value:Array},data:function(){return{menu:!1,dates:[]}},methods:{input:function(e){e.length>1&&(this.menu=!1,this.$emit("input",e))},clear:function(){this.dates=[],this.$emit("input",[])}},computed:{dateRangeText:function(){return this.dates.join(" ~ ")}},created:function(){this.value&&(this.dates=this.value)}}),r=l,o=a("2877"),s=a("6544"),u=a.n(s),c=a("2e4b"),d=a("e449"),m=a("8654"),f=Object(o["a"])(r,n,i,!1,null,null,null);t["a"]=f.exports;u()(f,{VDatePicker:c["a"],VMenu:d["a"],VTextField:m["a"]})}}]);
//# sourceMappingURL=chunk-4ec6eace.8ddf0985.js.map