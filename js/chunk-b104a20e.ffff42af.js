(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b104a20e"],{"1dde3":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{flat:"",color:t.color,dark:"",elevation:"1"}},[t.loading?a("v-card-title",{staticClass:"pb-0"},[a("v-skeleton-loader",{attrs:{type:"heading"}})],1):a("v-card-title",{staticClass:"pb-0"},[t.icon?a("v-icon",{staticClass:"px-2",attrs:{dark:""}},[t._v(t._s(t.icon))]):t._e(),t._v(" "+t._s(t.title)+" "),a("v-spacer"),t.appendIcon?a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){return t.$emit("click:icon")}}},[a("v-icon",[t._v(t._s(t.appendIcon))])],1):t._e()],1),a("v-card-text",[t.loading?a("v-row",[t.deposit?a("v-col",{staticClass:" white--text"},[a("v-skeleton-loader",{attrs:{type:"heading"}})],1):t._e(),a("v-col",{staticClass:" white--text"},[a("v-skeleton-loader",{attrs:{type:"heading"}})],1)],1):a("v-row",[t.deposit?a("v-col",{staticClass:" white--text"},[a("small",[t._v("Deposits")]),a("h1",[t._v(t._s(t.count))])]):t._e(),a("v-col",{staticClass:" white--text"},[a("small",[t._v("Total")]),a("h1",[t._v(t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:t.currency}).format(t.amount)))])])],1)],1)],1)},o=[],r=(a("a9e3"),{name:"Panel",props:{title:{type:String,default:"Total"},icon:{type:String,default:"mdi-"},count:{type:Number,default:0},amount:{type:Number,default:0},color:{type:String,default:"green"},deposit:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},currency:{type:String,default:"USD"},appendIcon:{type:String}}}),i=r,l=a("2877"),s=a("6544"),c=a.n(s),u=a("8336"),d=a("b0af"),m=a("99d9"),f=a("62ad"),p=a("132d"),v=a("0fd9"),y=a("3129"),g=a("2fa4"),h=Object(l["a"])(i,n,o,!1,null,null,null);e["a"]=h.exports;c()(h,{VBtn:u["a"],VCard:d["a"],VCardText:m["d"],VCardTitle:m["e"],VCol:f["a"],VIcon:p["a"],VRow:v["a"],VSkeletonLoader:y["a"],VSpacer:g["a"]})},"2e17":function(t,e,a){"use strict";a("99af");e["a"]={pad:function(t,e){var a=""+t;while(a.length<e)a="0"+a;return a},money:function(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)},get today(){var t=new Date;return t.setHours(0,0,0,0),t},get first_day_of_the_month(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),1)},get todayString(){var t=this.today,e=this.pad;return["".concat(t.getFullYear(),"-").concat(e(t.getMonth()+1,2),"-").concat(e(t.getDate(),2)),"".concat(t.getFullYear(),"-").concat(e(t.getMonth()+1,2),"-").concat(e(t.getDate(),2))]},get last7daysString(){var t=this.today,e=new Date(this.today.getTime());e.setDate(e.getDate()-7);var a=this.pad;return["".concat(e.getFullYear(),"-").concat(a(e.getMonth()+1,2),"-").concat(a(e.getDate(),2)),"".concat(t.getFullYear(),"-").concat(a(t.getMonth()+1,2),"-").concat(a(t.getDate(),2))]},get currentDateRange(){var t=this.today,e=this.pad;return["".concat(t.getFullYear(),"-").concat(e(t.getMonth()+1,2),"-01"),"".concat(t.getFullYear(),"-").concat(e(t.getMonth()+1,2),"-").concat(e(t.getDate(),2))]},findColorBetween:function(t,e,a){for(var n={},o=["r","g","b"],r=0;r<o.length;r++){var i=o[r];n[i]=Math.round(t[i]+(e[i]-t[i])*a/100)}return n}}},"9db7":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-text-field",t._g(t._b({attrs:{value:t.dateRangeText,readonly:"","hide-details":"",clearable:""},on:{"click:clear":t.clear}},"v-text-field",t.$attrs,!1),n))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-date-picker",{attrs:{range:""},on:{input:t.input},model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}})],1)},o=[],r=(a("a15b"),{name:"date-picker",props:{value:Array},data:function(){return{menu:!1,dates:[]}},methods:{input:function(t){t.length>1&&(this.menu=!1,this.$emit("input",t))},clear:function(){this.dates=[],this.$emit("input",[])}},computed:{dateRangeText:function(){return this.dates.join(" ~ ")}},created:function(){this.value&&(this.dates=this.value)}}),i=r,l=a("2877"),s=a("6544"),c=a.n(s),u=a("2e4b"),d=a("e449"),m=a("8654"),f=Object(l["a"])(i,n,o,!1,null,null,null);e["a"]=f.exports;c()(f,{VDatePicker:u["a"],VMenu:d["a"],VTextField:m["a"]})},b1e1:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",{staticClass:"mt-2",attrs:{elevation:"1"}},[a("v-card-title",[a("v-icon",{staticClass:"mx-2"},[t._v(" mdi-file-chart ")]),a("v-toolbar-title",[t._v("Report")])],1),a("v-card-text",[t.gLoading?a("v-row",[a("v-col",{attrs:{cols:"12",sm:"7"}},[a("v-skeleton-loader",{attrs:{type:"card-heading"}})],1),a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-skeleton-loader",{attrs:{type:"card-heading"}})],1),a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-skeleton-loader",{attrs:{type:"card-heading"}})],1),a("v-col",{attrs:{cols:"12",sm:"7"}},[a("v-skeleton-loader",{attrs:{type:"card-heading"}})],1)],1):a("v-row",[a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-date-picker",{model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}})],1),a("v-col",{attrs:{cols:"12",sm:"5"}},[a("app-auto-complete",{attrs:{hideAddNew:"",outlined:"","hide-details":"",rounded:"",dense:"",label:"Department",collection:"department",itemText:"name",itemValue:"_id"},model:{value:t.department,callback:function(e){t.department=e},expression:"department"}})],1),a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-select",{attrs:{label:"Report by",outlined:"","hide-details":"",rounded:"",dense:"",items:t.byItems},model:{value:t.by,callback:function(e){t.by=e},expression:"by"}})],1),a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-auto-complete",t._g(t._b({attrs:{hideAddNew:"",outlined:"","hide-details":"",rounded:"",dense:""},model:{value:t.autocomplete.value,callback:function(e){t.$set(t.autocomplete,"value",e)},expression:"autocomplete.value"}},"app-auto-complete",t.autocomplete.bind,!1),t.autocomplete.on))],1),t.isAffiliate?a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-auto-complete",t._b({ref:"subaffiliate",attrs:{rounded:"",outlined:"",dense:"",hideAddNew:"",label:"Subaffiliate",collection:"subaffiliate",itemText:"name",itemValue:"_id"},model:{value:t.subaffiliateValue,callback:function(e){t.subaffiliateValue=e},expression:"subaffiliateValue"}},"app-auto-complete",t.subaffiliateBind,!1))],1):t._e(),a("v-col",{attrs:{cols:"12",sm:"3"}},[a("v-btn",{attrs:{large:"",rounded:"",color:"green white--text",width:"100%"},on:{click:t.submit}},[t._v("Submit")])],1)],1)],1)],1),a("app-panel",{attrs:{title:"Total",count:t.totals.count,amount:t.totals.amount}}),a("v-card",{staticClass:"my-4",attrs:{elevation:"1"}},[a("v-data-table",{staticClass:"my-5 elevation-1",attrs:{loading:t.loading,headers:t.headers,"single-expand":!0,expanded:t.expanded,"show-expand":"","item-key":"_id",items:t.items},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"loading",fn:function(){return[a("v-skeleton-loader",{staticClass:"mt-6",attrs:{height:"94",type:"list-item-three-line"}})]},proxy:!0},{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"expanded-item",fn:function(e){var n=e.headers,o=e.item;return[a("td",{staticClass:"pa-4",attrs:{colspan:n.length}},[a("v-data-table",{attrs:{headers:t.dataHeaders,items:o.child},on:{"click:row":function(e){return t.innerListClick(e,o)}},scopedSlots:t._u([{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}}],null,!0)})],1)]}}])})],1),a("v-dialog",{attrs:{"max-width":"960"},model:{value:t.dialog.value,callback:function(e){t.$set(t.dialog,"value",e)},expression:"dialog.value"}},[a("v-card",[a("v-card-title",[t._v(" "+t._s(t.dialog.title)+" "),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialog.value=!1}}},[a("v-icon",[t._v("mdi-close")])],1),a("v-card-text",[a("v-data-table",{attrs:{headers:t.dialog.headers,items:t.dialog.items},scopedSlots:t._u([{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}}])})],1)],1)],1)],1)],1)},o=[],r=(a("99af"),a("a15b"),a("b0c0"),a("96cf"),a("1da1")),i=a("5530"),l=a("2909"),s=a("2e17"),c=a("bb0b"),u=a("9db7"),d=a("1dde3"),m=a("2f62"),f=a("b9b9"),p=a.n(f),v={customer:[{text:"TP Account",align:"start",value:"customer.tpc"},{text:"Account name",align:"start",value:"customer.name"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}],affiliate:[{text:"Affiliate",align:"start",value:"affiliate.name"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}],user:[{text:"Agent",align:"start",value:"user.displayName"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}]},y={customer:[{text:"Department",value:"department.name"},{text:"Date",value:"created_on"},{text:"Amount",value:"amount"},{text:"Owner",value:"user.displayName"}],affiliate:[{text:"TP Account",align:"start",value:"customer.tpc"},{text:"Account name",value:"customer.name"},{text:"Subaffiliate",value:"subaffiliate.name"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}],user:[{text:"TP Account",align:"start",value:"customer.tpc"},{text:"Account name",align:"start",value:"customer.name"},{text:"Deposits",value:"count"},{text:"Total",value:"amount"}]},g=[{text:"Customer",value:"customer"},{text:"Affiliate",value:"affiliate"},{text:"Agent",value:"user"}],h={customer:{label:"Customer",collection:"customer",itemText:"name",itemValue:"_id"},affiliate:{label:"Affiliate",collection:"affiliate",itemText:"name",itemValue:"_id"},user:{label:"Agent",collection:"user",itemText:"displayName",itemValue:"_id",or:!1,query:{role:["!wakel","!affiliate"]}}},b={customer:function(){return{}},affiliate:function(t){return{input:function(e){t.$refs.subaffiliate.query.affiliate=e||"!",e||(t.subaffiliateValue=null)}}},user:function(){return{}}},x={name:"Report",components:{AppDatePicker:u["a"],AppAutoComplete:c["a"],appPanel:d["a"]},data:function(){return{dateformat:p.a,dates:Object(l["a"])(s["a"].currentDateRange),department:"",byItems:g,by:"customer",autocomplete:{value:"",bind:h.customer,on:b.customer()},loading:!1,gLoading:!1,headers:v.customer,dataHeaders:y.customer,items:[],expanded:[],totals:{amount:0,count:0},dialog:{value:!1,title:"",items:[],headers:y.customer},subaffiliateValue:null,subaffiliateBind:{or:!1,query:{affiliate:"!"}}}},computed:{isAffiliate:function(){return"affiliate"==this.by}},watch:{by:function(){this.autocomplete.value="",this.autocomplete.bind=h[this.by],this.autocomplete.on=b[this.by](this),this.headers=v[this.by],this.dataHeaders=y[this.by],this.items=[]}},methods:Object(i["a"])(Object(i["a"])({},Object(m["b"])({get:"api/get"})),{},{submit:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,t.items=[],t.expanded=[],e.next=5,t.get({collection:"report_new",query:{department:t.department||null,by:t.by,created_on:t.dates.join("|"),id:t.autocomplete.value||null,subaffiliate:t.subaffiliateValue||null}});case 5:return a=e.sent,e.next=8,t.get({collection:"report_new/total",query:{department:t.department||null,by:t.by,created_on:t.dates.join("|"),id:t.autocomplete.value||null,subaffiliate:t.subaffiliateValue||null}});case 8:n=e.sent,console.log(a.data),t.totals.amount=n.data[0].amount,t.totals.count=n.data[0].count,t.items=a.data,t.loading=!1;case 14:case"end":return e.stop()}}),e)})))()},innerListClick:function(t){"customer"!=this.by&&(this.dialog.value=!0,this.dialog.items=t.child,this.dialog.title="(".concat(t.customer.tpc,") ").concat(t.customer.name))}}),created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.gLoading=!0,e.next=3,t.get({collection:"department",query:{type:"rtn"}});case 3:a=e.sent,a&&200==a.status&&(t.department=a.data.docs[0]._id),t.gLoading=!1;case 6:case"end":return e.stop()}}),e)})))()}},_=x,T=a("2877"),D=a("6544"),w=a.n(D),k=a("8336"),M=a("b0af"),S=a("99d9"),V=a("62ad"),C=a("a523"),N=a("8fea"),A=a("169a"),H=a("132d"),F=a("0fd9"),U=a("b974"),O=a("3129"),j=a("2fa4"),I=a("2a7f"),P=Object(T["a"])(_,n,o,!1,null,null,null);e["default"]=P.exports;w()(P,{VBtn:k["a"],VCard:M["a"],VCardText:S["d"],VCardTitle:S["e"],VCol:V["a"],VContainer:C["a"],VDataTable:N["a"],VDialog:A["a"],VIcon:H["a"],VRow:F["a"],VSelect:U["a"],VSkeletonLoader:O["a"],VSpacer:j["a"],VToolbarTitle:I["c"]})},b9b9:function(t,e,a){var n;(function(o){"use strict";var r=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,e=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g;return function(n,o,u,d){if(1!==arguments.length||"string"!==c(n)||/\d/.test(n)||(o=n,n=void 0),n=n||new Date,n instanceof Date||(n=new Date(n)),isNaN(n))throw TypeError("Invalid date");o=String(r.masks[o]||o||r.masks["default"]);var m=o.slice(0,4);"UTC:"!==m&&"GMT:"!==m||(o=o.slice(4),u=!0,"GMT:"===m&&(d=!0));var f=u?"getUTC":"get",p=n[f+"Date"](),v=n[f+"Day"](),y=n[f+"Month"](),g=n[f+"FullYear"](),h=n[f+"Hours"](),b=n[f+"Minutes"](),x=n[f+"Seconds"](),_=n[f+"Milliseconds"](),T=u?0:n.getTimezoneOffset(),D=l(n),w=s(n),k={d:p,dd:i(p),ddd:r.i18n.dayNames[v],dddd:r.i18n.dayNames[v+7],m:y+1,mm:i(y+1),mmm:r.i18n.monthNames[y],mmmm:r.i18n.monthNames[y+12],yy:String(g).slice(2),yyyy:g,h:h%12||12,hh:i(h%12||12),H:h,HH:i(h),M:b,MM:i(b),s:x,ss:i(x),l:i(_,3),L:i(Math.round(_/10)),t:h<12?r.i18n.timeNames[0]:r.i18n.timeNames[1],tt:h<12?r.i18n.timeNames[2]:r.i18n.timeNames[3],T:h<12?r.i18n.timeNames[4]:r.i18n.timeNames[5],TT:h<12?r.i18n.timeNames[6]:r.i18n.timeNames[7],Z:d?"GMT":u?"UTC":(String(n).match(e)||[""]).pop().replace(a,""),o:(T>0?"-":"+")+i(100*Math.floor(Math.abs(T)/60)+Math.abs(T)%60,4),S:["th","st","nd","rd"][p%10>3?0:(p%100-p%10!=10)*p%10],W:D,N:w};return o.replace(t,(function(t){return t in k?k[t]:t.slice(1,t.length-1)}))}}();function i(t,e){t=String(t),e=e||2;while(t.length<e)t="0"+t;return t}function l(t){var e=new Date(t.getFullYear(),t.getMonth(),t.getDate());e.setDate(e.getDate()-(e.getDay()+6)%7+3);var a=new Date(e.getFullYear(),0,4);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var n=e.getTimezoneOffset()-a.getTimezoneOffset();e.setHours(e.getHours()-n);var o=(e-a)/6048e5;return 1+Math.floor(o)}function s(t){var e=t.getDay();return 0===e&&(e=7),e}function c(t){return null===t?"null":void 0===t?"undefined":"object"!==typeof t?typeof t:Array.isArray(t)?"array":{}.toString.call(t).slice(8,-1).toLowerCase()}r.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},r.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},n=function(){return r}.call(e,a,e,t),void 0===n||(t.exports=n)})()}}]);
//# sourceMappingURL=chunk-b104a20e.ffff42af.js.map