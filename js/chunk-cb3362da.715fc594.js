(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cb3362da"],{7277:function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-content",{staticClass:"pa-0 ma-0"},[e("v-row",[e("v-col",[e("app-panel",{attrs:{title:"Today revenue",count:t.total.today.ftd,amount:t.total.today.amount}})],1),e("v-col",[e("app-panel",{attrs:{title:"This month revenue",count:t.total.month.ftd,amount:t.total.month.amount}})],1)],1),e("v-row",[e("app-total-sheet",{attrs:{title:"English",items:[{title:"Sales",ftd:t.totalToday.sales.en.ftd,total:t.totalToday.sales.en.total},{title:"Retentions",ftd:t.totalToday.retention.en.ftd,total:t.totalToday.retention.en.total},{title:"Total today",ftd:t.totalToday.sales.en.ftd+t.totalToday.retention.en.ftd,total:t.totalToday.sales.en.total+t.totalToday.retention.en.total},{title:"Total this month",ftd:t.totalMonth.sales.en.ftd+t.totalMonth.retention.en.ftd,total:t.totalMonth.sales.en.total+t.totalMonth.retention.en.total}]},on:{table:function(a){return t.showTable(a,"en")}}})],1),e("v-row",[e("app-total-sheet",{attrs:{title:"Arabic",items:[{title:"Sales",ftd:t.totalToday.sales.ar.ftd,total:t.totalToday.sales.ar.total},{title:"Retentions",ftd:t.totalToday.retention.ar.ftd,total:t.totalToday.retention.ar.total},{title:"Total today",ftd:t.totalToday.sales.ar.ftd+t.totalToday.retention.ar.ftd,total:t.totalToday.sales.ar.total+t.totalToday.retention.ar.total},{title:"Total this month",ftd:t.totalMonth.sales.ar.ftd+t.totalMonth.retention.ar.ftd,total:t.totalMonth.sales.ar.total+t.totalMonth.retention.ar.total}]},on:{table:function(a){return t.showTable(a,"ar")}}})],1),e("v-row",[e("app-total-sheet",{attrs:{title:"Label1",items:[{title:"Sales",ftd:t.totalToday.sales.lb.ftd,total:t.totalToday.sales.lb.total},{title:"Retentions",ftd:t.totalToday.retention.lb.ftd,total:t.totalToday.retention.lb.total},{title:"Total today",ftd:t.totalToday.sales.lb.ftd+t.totalToday.retention.lb.ftd,total:t.totalToday.sales.lb.total+t.totalToday.retention.lb.total},{title:"Total this month",ftd:t.totalMonth.sales.lb.ftd+t.totalMonth.retention.lb.ftd,total:t.totalMonth.sales.lb.total+t.totalMonth.retention.lb.total}]},on:{table:function(a){return t.showTable(a,"label1")}}})],1),e("v-dialog",{attrs:{"max-width":"950px"},model:{value:t.dialog,callback:function(a){t.dialog=a},expression:"dialog"}},[e("v-card",[e("v-card-title",[t._v(" "+t._s(t.dialogTitle)+" "),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(a){t.dialog=!1}}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[t.dialog?e("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.items,"multi-sort":""},on:{"click:row":t.goTo},scopedSlots:t._u([{key:"item.amount",fn:function(a){var e=a.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.amount))+" ")]}}],null,!1,2157523568)}):t._e()],1)],1)],1)],1)},l=[],n=(e("99af"),e("4160"),e("159b"),e("53ca")),r=(e("96cf"),e("1da1")),s=e("5530"),i=e("1dde3"),d=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-sheet",{staticClass:" mb-3 mx-3 ",attrs:{color:t.color,width:"100%"}},[e("v-toolbar",{staticClass:"mb-3",attrs:{dense:"",flat:"",color:t.color}},[e("v-toolbar-title",{staticClass:"title "},[t._v(t._s(t.title))]),e("v-spacer"),e("v-btn",{staticClass:"mx-2",attrs:{outlined:""},on:{click:function(a){return t.$emit("table","sale")}}},[t._v("Sales")]),e("v-btn",{staticClass:"mx-2",attrs:{outlined:""},on:{click:function(a){return t.$emit("table","retention")}}},[t._v("Retentions")])],1),e("v-row",{staticClass:"mx-1"},t._l("month"==t.selected?t.items:t.items2,(function(a,o){return e("v-col",{key:o,staticClass:"mx-2 pa-0 px-2"},[e("fieldset",{staticClass:"px-2 mb-2 fielset"},[e("legend",[t._v(t._s(a.title))]),a.table?e("v-btn",{attrs:{icon:""},on:{click:function(e){return t.$emit("table",a.table)}}},[e("v-icon",[t._v("mdi-table-multiple")])],1):t._e(),e("v-row",[e("v-col",{attrs:{cols:"3"}},[e("small",[t._v("Users")]),e("h2",[t._v(t._s(a.ftd||0))])]),e("v-col",[e("small",[t._v("Total")]),e("h2",[t._v(t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.total||0)))])])],1)],1)])})),1)],1)},c=[],u={name:"TotalSheet",props:{title:String,items:Array,items2:Array,color:{type:String,default:"green lighten-3"}},data:function(){return{selected:"month"}}},f=u,b=(e("e67a"),e("2877")),m=e("6544"),h=e.n(m),y=e("8336"),p=e("62ad"),v=e("132d"),T=e("0fd9"),g=e("8dd9"),_=e("2fa4"),w=e("71d9"),x=e("2a7f"),k=Object(b["a"])(f,d,c,!1,null,"28d6bca1",null),A=k.exports;h()(k,{VBtn:y["a"],VCol:p["a"],VIcon:v["a"],VRow:T["a"],VSheet:g["a"],VSpacer:_["a"],VToolbar:w["a"],VToolbarTitle:x["c"]});var C=e("2f62"),V=e("1157"),S=e.n(V),M=new Date,O={name:"Dashboard",components:{AppPanel:i["a"],AppTotalSheet:A},data:function(){return{range:{start:new Date(M.getFullYear(),M.getMonth(),1),end:new Date},dialog:!1,dialogTitle:"",dialogColl:"sale",tab:0,bu:"en",items:[],headers:[{text:"Created By",align:"start",value:"_id.displayName"},{text:"Deals",value:"count"},{text:"Amount",value:"amount"}],totalMonth:{sales:{en:{ftd:0,total:0},ar:{ftd:0,total:0},lb:{ftd:0,total:0}},retention:{en:{ftd:0,total:0},ar:{ftd:0,total:0},lb:{ftd:0,total:0}}},totalToday:{sales:{en:{ftd:0,total:0},ar:{ftd:0,total:0},lb:{ftd:0,total:0}},retention:{en:{ftd:0,total:0},ar:{ftd:0,total:0},lb:{ftd:0,total:0}}},total:{today:{ftd:0,amount:0},month:{ftd:0,amount:0}}}},computed:Object(s["a"])({},Object(C["d"])({io:function(t){return t.api.io}})),methods:Object(s["a"])(Object(s["a"])({},Object(C["b"])({get:"api/get",snackbarOpen:"snackbar/open"})),{},{goTo:function(t){var a={filterBy:["user","business_unit"],filterValue:[t._id._id,this.bu],sortBy:["created_on"],sortDesc:[!1]};this.$router.push("/"+this.dialogColl+"?"+S.a.param(a))},showTable:function(t,a){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function o(){var l,r;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.dialogColl=t,e.bu=a,o.t0=a,o.next="ar"===o.t0?5:"label1"===o.t0?7:9;break;case 5:return e.dialogTitle="Arabic "+t,o.abrupt("break",11);case 7:return e.dialogTitle="Label1 "+t,o.abrupt("break",11);case 9:return e.dialogTitle="English "+t,o.abrupt("break",11);case 11:return e.dialog=!0,o.next=14,e.get({collection:"dashboard/table",query:{collection:t,business_unit:a}});case 14:l=o.sent,r=l.data,console.log(Object(n["a"])(r)),e.items=r;case 18:case"end":return o.stop()}}),o)})))()},update:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var e,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.get({collection:"dashboard/month"});case 2:return e=a.sent,a.next=5,t.get({collection:"dashboard/today"});case 5:o=a.sent,e&&200==e.status&&(t.total.month.ftd=(e.data.rtsAll[0]?e.data.rtsAll[0].count:0)+(e.data.salesAll[0]?e.data.salesAll[0].count:0),t.total.month.amount=(e.data.rtsAll[0]?e.data.rtsAll[0].amount:0)+(e.data.salesAll[0]?e.data.salesAll[0].amount:0),e.data.sales.forEach((function(a){t.totalMonth.sales[a._id].ftd=a.count,t.totalMonth.sales[a._id].total=a.amount})),e.data.rts.forEach((function(a){t.totalMonth.retention[a._id].ftd=a.count,t.totalMonth.retention[a._id].total=a.amount}))),o&&200==o.status&&(t.total.today.ftd=(o.data.rtsAll[0]?o.data.rtsAll[0].count:0)+(o.data.salesAll[0]?o.data.salesAll[0].count:0),t.total.today.amount=(o.data.rtsAll[0]?o.data.rtsAll[0].amount:0)+(o.data.salesAll[0]?o.data.salesAll[0].amount:0),o.data.sales.forEach((function(a){t.totalToday.sales[a._id].ftd=a.count,t.totalToday.sales[a._id].total=a.amount})),o.data.rts.forEach((function(a){t.totalToday.retention[a._id].ftd=a.count,t.totalToday.retention[a._id].total=a.amount})));case 8:case"end":return a.stop()}}),a)})))()},notefy:function(t){switch(t.type){case"new_sale":this.snackbarOpen(["New (".concat(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.amount),") Sale has been made by ").concat(t.user),"white black--text","right","bottom"]),this.update();break;default:break}console.log(t)}}),created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.update(),t.io.on("notefy",t.notefy);case 2:case"end":return a.stop()}}),a)})))()},destroyed:function(){this.io.off("notefy",this.notefy)}},R=O,j=e("b0af"),D=e("99d9"),E=e("a75b"),U=e("8fea"),$=e("169a"),B=Object(b["a"])(R,o,l,!1,null,null,null);a["default"]=B.exports;h()(B,{VBtn:y["a"],VCard:j["a"],VCardText:D["d"],VCardTitle:D["e"],VCol:p["a"],VContent:E["a"],VDataTable:U["a"],VDialog:$["a"],VIcon:v["a"],VRow:T["a"],VSpacer:_["a"]})},b745:function(t,a,e){},e67a:function(t,a,e){"use strict";var o=e("b745"),l=e.n(o);l.a}}]);
//# sourceMappingURL=chunk-cb3362da.715fc594.js.map