(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74f41715"],{"0b02":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",[a("v-card-title",[a("v-icon",{staticClass:"mx-2"},[e._v("mdi-file-chart")]),e._v(" Report")],1),a("v-card-text",{staticClass:"px-6"},[a("v-form",{ref:"form"},[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-select",{attrs:{required:"",rules:[function(e){return!!e||"this field is required"}],rounded:"",outlined:"",dense:"",label:"Report",items:e.types,"item-text":"text","item-value":"value"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-datepicker",{model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1),a("v-col",{attrs:{cols:"12",sm:"9"}},[a("app-autocomplete",e._b({attrs:{rounded:"",outlined:"",dense:""},model:{value:e.autocomplete.value,callback:function(t){e.$set(e.autocomplete,"value",t)},expression:"autocomplete.value"}},"app-autocomplete",e.autocomplete.bind,!1))],1),a("v-col",{attrs:{cols:"12",sm:"3"}},[a("v-btn",{attrs:{large:"",rounded:"",color:"green white--text",width:"100%"},on:{click:e.submit}},[e._v("Submit")])],1)],1)],1)],1)],1),a("v-data-table",{staticClass:"my-5 elevation-1",attrs:{loading:e.loading,headers:e.headers,"single-expand":e.singleExpand,expanded:e.expanded,"show-expand":"","item-key":"_id._id",items:e.items},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"loading",fn:function(){return[a("v-skeleton-loader",{staticClass:"mt-6",attrs:{height:"94",type:"list-item-three-line"}})]},proxy:!0},{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"expanded-item",fn:function(t){var n=t.headers,i=t.item;return[a("td",{staticClass:"pa-4",attrs:{colspan:n.length}},[a("v-data-table",{attrs:{loading:e.exLoading,headers:e.dataHeaders,items:e.dataItems},on:{"click:row":function(t){return e.innerListClick(t,i)}},scopedSlots:e._u([{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s((new Intl.DateTimeFormat).format(new Date(a.created_on)))+" ")]}},{key:"loading",fn:function(){return[a("v-skeleton-loader",{staticClass:"mt-6",attrs:{height:"94",type:"list-item-three-line"}})]},proxy:!0}],null,!0)})],1)]}}])}),a("v-dialog",{attrs:{scrollable:"","max-width":"960px"},model:{value:e.dialog.value,callback:function(t){e.$set(e.dialog,"value",t)},expression:"dialog.value"}},[a("v-card",[a("v-card-title",{domProps:{innerHTML:e._s(e.dialog.title)}}),a("v-divider"),a("v-card-text",{staticStyle:{height:"300px"}},[a("v-data-table",{attrs:{headers:e.dialog.headers,items:e.dialog.items,loading:e.dialog.loading},scopedSlots:e._u([{key:"loading",fn:function(){return[a("v-skeleton-loader",{staticClass:"mt-6",attrs:{height:"94",type:"list-item-three-line"}})]},proxy:!0},{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s((new Intl.DateTimeFormat).format(new Date(a.created_on)))+" ")]}}])})],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog.value=!1}}},[e._v("Close")])],1)],1)],1)],1)},i=[],o=(a("99af"),a("a15b"),a("b0c0"),a("5530")),r=(a("96cf"),a("1da1")),l=a("bb0b"),c=a("9db7"),s=a("2f62"),d=[{text:"TP Account",align:"start",value:"_id.tpc"},{text:"Account name",align:"start",value:"_id.name"},{text:"Affiliate",value:"_id.affiliate.name"},{text:"Deposits",value:"count",width:"10%"},{text:"Total",value:"amount"}],u=[{text:"Affiliate",align:"start",value:"_id.name"},{text:"Deposits",value:"count",width:"10%"},{text:"Total",value:"amount"}],m=[{text:"Agent",align:"start",value:"_id.displayName"},{text:"Deposits",value:"count",width:"10%"},{text:"Total",value:"amount"}],p=[{text:"Department",value:"department.name"},{text:"Date",value:"created_on"},{text:"Amount",value:"amount"},{text:"Payment Method",value:"payment_method.name"}],v=[{text:"TP Account",align:"start",value:"_id.tpc"},{text:"Account name",align:"start",value:"_id.name"},{text:"Deposits",value:"count",width:"10%"},{text:"Amount",value:"amount"}],f=[{text:"TP Account",align:"start",value:"_id.tpc"},{text:"Account name",align:"start",value:"_id.name"},{text:"Affilaite",align:"start",value:"_id.affiliate.name"},{text:"Deposits",value:"count",width:"10%"},{text:"Amount",value:"amount"}];function b(e,t){var a=""+e;while(a.length<t)a="0"+a;return a}var g={name:"Report",components:{"app-autocomplete":l["a"],"app-datepicker":c["a"]},data:function(){var e=new Date;e.setHours(0,0,0,0);var t=["".concat(e.getFullYear(),"-").concat(b(e.getMonth()+1,2),"-01"),"".concat(e.getFullYear(),"-").concat(b(e.getMonth()+1,2),"-").concat(b(e.getDate(),2))];return{loading:!1,exLoading:!1,dialog:{value:!1,headers:p,items:[],title:"",loading:!1},dataItems:[],dataHeaders:p,expanded:[],singleExpand:!0,items:[],headers:d,types:[{text:"By Lead",value:"lead"},{text:"By Affiliate",value:"affiliate"},{text:"By Agent",value:"agent"}],type:"lead",autocomplete:{value:"",bind:{collection:"customer",itemValue:"_id",itemText:"name",hideAddNew:!0,label:"Select a lead",searchFields:["name","tpc"]}},dates:t}},watch:{expanded:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,i,r,l,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.length){a.next=24;break}t.exLoading=!0,a.t0=t.type,a.next="lead"===a.t0?5:"affiliate"===a.t0?10:"agent"===a.t0?16:23;break;case 5:return a.next=7,t.get({collection:"deposit",query:{created_on:t.dates.join("|"),customer:e[0]._id._id,sortBy:["created_on"],sortDesc:[!0]}});case 7:return n=a.sent,t.dataItems=n.data.docs,a.abrupt("break",23);case 10:return i={created_on:t.dates.join("|"),"affiliate._id":e[0]._id._id},a.next=13,t.get({collection:"report_old/affiliate",query:Object(o["a"])(Object(o["a"])({groupBy:"customer._id"},i),{},{meta:{collection:"customer"},sortBy:["customer.tpc","created_on"],sortDesc:[1,1]})});case 13:return r=a.sent,t.dataItems=r.data,a.abrupt("break",23);case 16:return l={created_on:t.dates.join("|"),user:e[0]._id._id},a.next=19,t.get({collection:"report_old/agent",query:Object(o["a"])(Object(o["a"])({groupBy:"customer._id"},l),{},{meta:{collection:"customer"},sortBy:["customer.affiliate.name","created_on"],sortDesc:[1,1]})});case 19:return c=a.sent,console.log(c),t.dataItems=c.data,a.abrupt("break",23);case 23:t.exLoading=!1;case 24:case"end":return a.stop()}}),a)})))()},type:function(e){switch(this.items=[],this.autocomplete.value="",e){case"lead":this.autocomplete.bind.collection="customer",this.autocomplete.bind.itemText="name",this.autocomplete.bind.label="Select a lead",this.autocomplete.bind.searchFields=["name","tpc"],this.headers=d,this.dataHeaders=p;break;case"affiliate":this.autocomplete.bind.collection="affiliate",this.autocomplete.bind.itemText="name",this.autocomplete.bind.label="Select an affiliate",delete this.autocomplete.bind.searchFields,this.headers=u,this.dataHeaders=v;break;case"agent":this.autocomplete.bind.collection="user",this.autocomplete.bind.itemText="displayName",this.autocomplete.bind.label="Select an agent",delete this.autocomplete.bind.searchFields,this.headers=m,this.dataHeaders=f;break}}},methods:Object(o["a"])(Object(o["a"])({},Object(s["b"])({get:"api/get"})),{},{innerListClick:function(e,t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i,o,r,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a.dialog.loading=!0,"affiliate"!=a.type){n.next=9;break}return i=e._id._id,n.next=5,a.get({collection:"deposit",query:{created_on:a.dates.join("|"),customer:i,limit:1e3,sortBy:["created_on"],sortDesc:[!0]}});case 5:o=n.sent,a.dialog.value=!0,a.dialog.items=o.data.docs,a.dialog.title="( <small>".concat(e._id.tpc,"</small> ) ").concat(e._id.name);case 9:if("agent"!=a.type){n.next=17;break}return r=e._id._id,n.next=13,a.get({collection:"deposit",query:{created_on:a.dates.join("|"),customer:r,user:t._id._id,limit:1e3,sortBy:["created_on"],sortDesc:[!0]}});case 13:l=n.sent,a.dialog.value=!0,a.dialog.items=l.data.docs,a.dialog.title="( <small>".concat(e._id.tpc,"</small> ) ").concat(e._id.name);case 17:a.dialog.loading=!1;case 18:case"end":return n.stop()}}),n)})))()},submit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=21;break}a=e.autocomplete.bind.collection,n={created_on:e.dates.join("|")},t.t0=a,t.next="affiliate"===t.t0?6:"customer"===t.t0?8:10;break;case 6:return i="affiliate._id",t.abrupt("break",12);case 8:return i="customer._id",t.abrupt("break",12);case 10:return i=a,t.abrupt("break",12);case 12:return e.autocomplete.value&&(n[i]=e.autocomplete.value),e.loading=!0,t.next=16,e.get({collection:"report_old",query:Object(o["a"])(Object(o["a"])({groupBy:"$"+i,meta:{collection:a}},n),{},{sortBy:["_id.tpc"],sortDesc:[1]})});case 16:r=t.sent,e.items=r.data,e.loading=!1,t.next=22;break;case 21:e.$store.commit("error","form not valid");case 22:case"end":return t.stop()}}),t)})))()}})},h=g,x=a("2877"),_=a("6544"),y=a.n(_),k=a("8336"),w=a("b0af"),D=a("99d9"),j=a("62ad"),T=a("a523"),V=a("8fea"),A=a("169a"),S=a("ce7e"),C=a("4bd4"),O=a("132d"),B=a("0fd9"),F=a("b974"),I=a("3129"),R=Object(x["a"])(h,n,i,!1,null,null,null);t["default"]=R.exports;y()(R,{VBtn:k["a"],VCard:w["a"],VCardActions:D["b"],VCardText:D["d"],VCardTitle:D["e"],VCol:j["a"],VContainer:T["a"],VDataTable:V["a"],VDialog:A["a"],VDivider:S["a"],VForm:C["a"],VIcon:O["a"],VRow:B["a"],VSelect:F["a"],VSkeletonLoader:I["a"]})},"9db7":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{prependInnerIcon:"mdi-calendar",rounded:"",outlined:"",dense:"",value:e.dateRangeText,label:"Date",readonly:"","hide-details":"",clearable:""},on:{"click:clear":e.clear}},"v-text-field",i,!1),n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-date-picker",{attrs:{range:""},on:{input:e.input},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1)},i=[],o=(a("a15b"),{name:"date-picker",props:{value:Array},data:function(){return{menu:!1,dates:[]}},methods:{input:function(e){e.length>1&&(this.menu=!1,this.$emit("input",e))},clear:function(){this.dates=[],this.$emit("input",[])}},computed:{dateRangeText:function(){return this.dates.join(" ~ ")}},created:function(){this.value&&(this.dates=this.value)}}),r=o,l=a("2877"),c=a("6544"),s=a.n(c),d=a("2e4b"),u=a("e449"),m=a("8654"),p=Object(l["a"])(r,n,i,!1,null,null,null);t["a"]=p.exports;s()(p,{VDatePicker:d["a"],VMenu:u["a"],VTextField:m["a"]})}}]);
//# sourceMappingURL=chunk-74f41715.a2023ea1.js.map