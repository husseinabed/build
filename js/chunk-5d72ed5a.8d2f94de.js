(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d72ed5a"],{7277:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",{staticClass:"mb-6"},[a("v-col",{attrs:{cols:"xs"==t.$vuetify.breakpoint.name?12:6}},[a("total-panel",{attrs:{title:"Today",count:t.totals.today.count,amount:t.totals.today.amount}})],1),a("v-col",{attrs:{cols:"xs"==t.$vuetify.breakpoint.name?12:6}},[a("total-panel",{attrs:{title:"This month",count:t.totals.month.count,amount:t.totals.month.amount}})],1)],1),t.isAdmin?a("v-row",t._l(t.businesses,(function(t){return a("total-sheet",{key:t._id,attrs:{title:t.name,id:t._id}})})),1):t._e(),t.isAdmin?t._e():a("v-row",[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[t._v(" Today deposits ")]),a("v-spacer"),a("v-btn",{attrs:{color:"green white--text mx-2"},on:{click:function(e){return t.$router.push("/deposit/new")}}},[a("v-icon",[t._v("mdi-plus")]),t._v(" New deposit")],1)],1),a("v-data-table",{attrs:{headers:t.headers,items:t.deposits},on:{"click:row":function(e){return t.$router.push("/deposit/"+e._id)}},scopedSlots:t._u([{key:"item.created_on",fn:function(e){var a=e.item;return[t._v(" "+t._s(a.created_on.split("T")[0])+" ")]}},{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}}],null,!1,1898337705)})],1),a("v-divider",{staticClass:"my-6"}),t.isAdmin?t._e():a("v-row",[a("v-data-table",{staticStyle:{width:"100%"},attrs:{headers:t.mheaders,items:t.mdeposits},on:{"click:row":t.goTo},scopedSlots:t._u([{key:"item._id.date",fn:function(e){var a=e.item;return[t._v(" "+t._s(a._id.date.split("T")[0])+" ")]}},{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}}],null,!1,1672155689)})],1)],1)},o=[],r=(a("4de4"),a("96cf"),a("1da1")),s=a("5530"),i=a("1dde3"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-sheet",{staticClass:" mb-3 mx-3 ",attrs:{color:t.color,width:"100%",elevation:"2"}},[a("v-toolbar",{staticClass:"mb-3",attrs:{dense:"",flat:"",color:t.color}},[a("v-toolbar-title",{staticClass:"title "},[t._v(t._s(t.title))]),a("v-spacer")],1),a("v-row",{staticClass:"mx-1"},[t._l(t.departments,(function(e,n){return a("v-col",{key:n,staticClass:"mx-2 pa-0 px-2",attrs:{cols:"xs"==t.$vuetify.breakpoint.name?12:null}},[a("fieldset",{staticClass:"px-2 mb-2 fielset"},[a("legend",[t._v(t._s(e._id.name))]),a("v-row",[a("v-col",[a("small",[t._v("Deposits")]),a("h2",[t._v(t._s(e.count||0))])]),a("v-col",[a("small",[t._v("Total")]),a("h2",[t._v(t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.amount||0)))])])],1)],1)])})),a("v-col",{staticClass:"mx-2 pa-0 px-2",attrs:{cols:"xs"==t.$vuetify.breakpoint.name?12:null}},[a("fieldset",{staticClass:"px-2 mb-2 fielset"},[a("legend",[t._v("Total today")]),a("v-row",[a("v-col",[a("small",[t._v("Deposits")]),a("h2",[t._v(t._s(t.todayTotal.count||0))])]),a("v-col",[a("small",[t._v("Total")]),a("h2",[t._v(t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.todayTotal.amount||0)))])])],1)],1)]),a("v-col",{staticClass:"mx-2 pa-0 px-2",attrs:{cols:"xs"==t.$vuetify.breakpoint.name?12:null}},[a("fieldset",{staticClass:"px-2 mb-2 fielset"},[a("legend",[t._v("Total this month")]),a("v-row",[a("v-col",[a("small",[t._v("Deposits")]),a("h2",[t._v(t._s(t.monthTotal.count||0))])]),a("v-col",[a("small",[t._v("Total")]),a("h2",[t._v(t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.monthTotal.amount||0)))])])],1)],1)])],2),a("v-row",[a("v-col",t._l(t.departmentsNames,(function(e,n){return a("v-btn",{key:n,staticClass:"mx-2",attrs:{outlined:""},on:{click:function(a){return t.table(e._id)}}},[t._v(t._s(e.name))])})),1)],1),a("v-dialog",{attrs:{"max-width":"950px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",[t._v(" "+t._s(t.dialogTitle)+" "),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialog=!1}}},[a("v-icon",[t._v("mdi-close")])],1)],1),a("v-card-text",[t.dialog?a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.items,"multi-sort":""},on:{"click:row":t.goTo},scopedSlots:t._u([{key:"item.amount",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}}],null,!1,2157523568)}):t._e()],1)],1)],1)],1)},u=[],c=a("1157"),d=a.n(c),m=a("2f62"),v={name:"TotalSheet",props:{title:String,id:String,color:{type:String,default:"blue lighten-4"}},data:function(){return{dialog:!1,dialogTitle:"",items:[],headers:[{text:"Created By",align:"start",value:"_id.displayName"},{text:"Deals",value:"count"},{text:"Amount",value:"amount"}],selected:"month",departments:[],departmentsNames:[],todayTotal:{count:0,amount:0},monthTotal:{count:0,amount:0}}},methods:Object(s["a"])(Object(s["a"])({},Object(m["b"])({get:"api/get"})),{},{table:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e.id,t),a.next=3,e.get({collection:"dashboard/tables",query:{query:{created_on:{type:"gte",value:e.first_day_of_the_month.getTime(),cast:"date"},business:{type:"normal",value:e.id,cast:"id"},department:{type:"normal",value:t,cast:"id"}}}});case 3:n=a.sent,e.items=n.data,console.log(n),e.dialog=!0;case 7:case"end":return a.stop()}}),a)})))()},goTo:function(t){var e={filterBy:["user","business","created_on"],filterValue:[t._id._id,this.id,this.first_day_of_the_month],filterCast:["id","normal","date"],filterType:["normal","normal","gte"],sortBy:["created_on"],sortDesc:[!1]};this.$router.push("/deposit?"+d.a.param(e))}}),computed:{today:function(){var t=new Date;return t.setHours(0,0,0,0),t},first_day_of_the_month:function(){return new Date(this.today.getFullYear(),this.today.getMonth(),1)}},created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.get({collection:"department"});case 2:return a=e.sent,a&&200==a.status&&(t.departmentsNames=a.data.docs),e.next=6,t.get({collection:"dashboard/business",query:{query:{created_on:{type:"gte",value:t.today.getTime(),cast:"date"},business:{type:"normal",value:t.id,cast:"id"}}}});case 6:return n=e.sent,n&&200==n.status&&(t.departments=n.data.departmentsTotal,n.data.total[0]&&(t.todayTotal.count=n.data.total[0].count,t.todayTotal.amount=n.data.total[0].amount)),e.next=10,t.get({collection:"dashboard/total",query:{query:{created_on:{type:"gte",value:t.first_day_of_the_month.getTime(),cast:"date"},business:{type:"normal",value:t.id,cast:"id"}}}});case 10:o=e.sent,o&&200==o.status&&o.data[0]&&(t.monthTotal.count=o.data[0].count,t.monthTotal.amount=o.data[0].amount);case 12:case"end":return e.stop()}}),e)})))()}},h=v,p=(a("bd26"),a("2877")),f=a("6544"),_=a.n(f),y=a("8336"),g=a("b0af"),b=a("99d9"),w=a("62ad"),T=a("8fea"),x=a("169a"),k=a("132d"),D=a("0fd9"),V=a("8dd9"),C=a("2fa4"),S=a("71d9"),O=a("2a7f"),j=Object(p["a"])(h,l,u,!1,null,"24f3161a",null),q=j.exports;_()(j,{VBtn:y["a"],VCard:g["a"],VCardText:b["d"],VCardTitle:b["e"],VCol:w["a"],VDataTable:T["a"],VDialog:x["a"],VIcon:k["a"],VRow:D["a"],VSheet:V["a"],VSpacer:C["a"],VToolbar:S["a"],VToolbarTitle:O["c"]});var R=a("fb57"),N=R["default"].get("deposit").table.filter((function(t){return"actions"!==t.value})),U={name:"Dashboard",components:{TotalPanel:i["a"],TotalSheet:q},data:function(){return{totals:{today:{count:0,amount:0},month:{count:0,amount:0}},businesses:[],deposits:[],mdeposits:[],headers:N,mheaders:[{text:"Date",align:"start",value:"_id.date",width:"30%"},{text:"Created By",align:"start",value:"_id.user.displayName",width:"30%"},{text:"Deposits",value:"count",width:"30%"},{text:"Total",value:"amount"}]}},computed:Object(s["a"])(Object(s["a"])({},Object(m["d"])({user:function(t){return t.auth.user}})),{},{isAdmin:function(){return!this.user.business},isManager:function(){var t=this.user.rights.filter((function(t){return"deposit"==t.collection}));return this.user.business&&"all"==t[0].read.allOwn},today:function(){var t=new Date;return t.setHours(0,0,0,0),t},first_day_of_the_month:function(){return new Date(this.today.getFullYear(),this.today.getMonth(),1)}}),methods:Object(s["a"])(Object(s["a"])({},Object(m["b"])({get:"api/get"})),{},{goTo:function(t){var e={filterBy:["user","business","created_on"],filterValue:[t._id.user._id,this.id,t._id.date],filterCast:["id","normal","date"],filterType:["normal","normal","normal"],sortBy:["created_on"],sortDesc:[!1]};this.$router.push("/deposit?"+d.a.param(e))},getTotals:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.get({collection:"dashboard/total",query:{query:{created_on:{type:"gte",value:t.today.getTime(),cast:"date"}}}});case 2:return a=e.sent,e.next=5,t.get({collection:"dashboard/total",query:{query:{created_on:{type:"gte",value:t.first_day_of_the_month.getTime(),cast:"date"}}}});case 5:n=e.sent,a&&200==a.status&&a.data.length&&(t.totals.today.count=a.data[0].count,t.totals.today.amount=a.data[0].amount),n&&200==n.status&&n.data.length&&(t.totals.month.count=n.data[0].count,t.totals.month.amount=n.data[0].amount);case 8:case"end":return e.stop()}}),e)})))()},getDesksTotals:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isAdmin){e.next=5;break}return e.next=3,t.get({collection:"business",query:{sortBy:["name"],sortDesc:[!0]}});case 3:a=e.sent,a&&200==a.status&&a.data.docs.length&&(t.businesses=a.data.docs);case 5:case"end":return e.stop()}}),e)})))()},getTodayDeposits:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.get({collection:"deposit",query:{query:{created_on:{type:"gte",value:t.today.getTime(),cast:"date"}}}});case 2:a=e.sent,t.deposits=a.data.docs;case 4:case"end":return e.stop()}}),e)})))()},getMonthDeposits:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.get({collection:"dashboard/grouped",query:{query:{created_on:{type:"gte",value:t.first_day_of_the_month.getTime(),cast:"date"}}}});case 2:a=e.sent,console.log(a),t.mdeposits=a.data;case 5:case"end":return e.stop()}}),e)})))()}}),created:function(){this.getTotals(),this.getDesksTotals(),this.getTodayDeposits(),this.getMonthDeposits()}},$=U,B=a("a523"),F=a("ce7e"),I=Object(p["a"])($,n,o,!1,null,null,null);e["default"]=I.exports;_()(I,{VBtn:y["a"],VCol:w["a"],VContainer:B["a"],VDataTable:T["a"],VDivider:F["a"],VIcon:k["a"],VRow:D["a"],VSpacer:C["a"],VToolbar:S["a"],VToolbarTitle:O["c"]})},bd26:function(t,e,a){"use strict";var n=a("dfba"),o=a.n(n);o.a},dfba:function(t,e,a){}}]);
//# sourceMappingURL=chunk-5d72ed5a.8d2f94de.js.map