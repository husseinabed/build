(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69751eb4"],{"762c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[e._v(" "+e._s(e.isAffiliate)+" "),a("v-card",[a("v-card-title",[a("v-icon",{staticClass:"mx-2"},[e._v("mdi-chart-line")]),e._v(" Upsales Sales")],1),a("v-card-text",{staticClass:"px-6"},[a("v-form",{ref:"form"},[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-select",{attrs:{required:"",rules:[function(e){return!!e||"this field is required"}],rounded:"",outlined:"",dense:"",label:"Report",items:e.types,"item-text":"text","item-value":"value"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),a("v-col",{attrs:{cols:"12",sm:"7"}},[a("app-datepicker",{model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1),a("v-col",{attrs:{cols:"12",sm:e.isAffiliate?5:9}},[a("app-autocomplete",e._b({attrs:{rounded:"",outlined:"",dense:""},on:{input:e.setTag},model:{value:e.autocomplete.value,callback:function(t){e.$set(e.autocomplete,"value",t)},expression:"autocomplete.value"}},"app-autocomplete",e.autocomplete.bind,!1))],1),e.isAffiliate?a("v-col",{attrs:{cols:"12",sm:4}},[a("app-autocomplete",e._b({ref:"subaffiliate",attrs:{rounded:"",outlined:"",dense:"",hideAddNew:"",label:"Tag",collection:"subaffiliate",itemText:"name",itemValue:"_id"},model:{value:e.subaffiliateValue,callback:function(t){e.subaffiliateValue=t},expression:"subaffiliateValue"}},"app-autocomplete",e.subaffiliateBind,!1))],1):e._e(),a("v-col",{attrs:{cols:"12",sm:"3"}},[a("v-btn",{attrs:{large:"",rounded:"",color:"green white--text",width:"100%"},on:{click:e.submit}},[e._v("Submit")])],1)],1)],1)],1)],1),a("v-data-table",{staticClass:"my-5 elevation-1",attrs:{loading:e.loading,headers:e.headers,"single-expand":e.singleExpand,expanded:e.expanded,"show-expand":"","item-key":"_id",items:e.items},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"loading",fn:function(){return[a("v-skeleton-loader",{staticClass:"mt-6",attrs:{height:"94",type:"list-item-three-line"}})]},proxy:!0},{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.total.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.total.amount))+" ")]}},{key:"item.count",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.child.length)+" ")]}},{key:"item.deposits",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.getDeposits(a.child))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}},{key:"expanded-item",fn:function(t){var n=t.headers,i=t.item;return[a("td",{staticClass:"pa-4",attrs:{colspan:n.length}},[a("v-data-table",{attrs:{headers:e.dataHeaders,items:i.child},on:{"click:row":function(t){return e.innerListClick(t,i)}},scopedSlots:e._u([{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.ftd.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.ftd.amount))+" ")]}},{key:"item.total.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.total?a.total.amount:0))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}},{key:"item.ftd.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.dateformat(new Date(a.ftd.created_on),"yyyy-mm-dd"))+" ")]}},{key:"item.count",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.child.length)+" ")]}}],null,!0)})],1)]}}])}),a("v-dialog",{attrs:{scrollable:"","max-width":"960px"},model:{value:e.dialog.value,callback:function(t){e.$set(e.dialog,"value",t)},expression:"dialog.value"}},[a("v-card",[a("v-card-title",{domProps:{innerHTML:e._s(e.dialog.title)}}),a("v-divider"),a("v-card-text",{staticStyle:{height:"300px"}},[a("v-data-table",{attrs:{headers:e.dialog.headers,items:e.dialog.items},scopedSlots:e._u([{key:"item.amount",fn:function(t){var a=t.item;return[e._v(" "+e._s(new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.amount))+" ")]}},{key:"item.created_on",fn:function(t){var a=t.item;return[e._v(" "+e._s(e.dateformat(new Date(a.created_on),"yyyy-mm-dd"))+" ")]}}])})],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog.value=!1}}},[e._v("Close")])],1)],1)],1)],1)},i=[],r=(a("99af"),a("a15b"),a("d81d"),a("13d5"),a("b0c0"),a("96cf"),a("1da1")),l=a("5530"),o=a("bb0b"),s=a("9db7"),u=a("2f62"),c=a("b9b9"),d=a.n(c),m=[{text:"TP Account",align:"start",value:"customer.tpc",width:"10%"},{text:"Account name",align:"start",value:"customer.name"},{text:"Owner conversion",value:"user.displayName"},{text:"FTD",value:"amount"},{text:"Deposits",value:"count"},{text:"Total",value:"total.amount"},{text:"Date",value:"created_on"}],f=[{text:"Affiliate",align:"start",value:"name"},{text:"FTDs",value:"count"}],v=[{text:"Agent",align:"start",value:"displayName"},{text:"FTD",value:"child.length"}],p=[{text:"Date",value:"created_on"},{text:"Amount",value:"amount"},{text:"Owner",value:"user.displayName"}],y=[{text:"TP Account",align:"start",value:"customer.tpc",width:"10%"},{text:"Account name",align:"start",value:"customer.name"},{text:"Tag",align:"start",value:"subaffiliate.name"},{text:"Owner conversion",value:"user.displayName"},{text:"FTD",value:"amount"},{text:"Deposits",value:"count"},{text:"Total",value:"total.amount"},{text:"Date",value:"created_on"}],h=[{text:"TP Account",align:"start",value:"tpc"},{text:"Account name",align:"start",value:"name"},{text:"Owner conversion",value:"ftd.user.displayName"},{text:"FTD",value:"ftd.amount"},{text:"FTD Date",value:"ftd.created_on"},{text:"Deposits",value:"child.length"},{text:"Owner Total",value:"total.amount"}];function b(e,t){var a=""+e;while(a.length<t)a="0"+a;return a}var g={name:"Report",components:{"app-autocomplete":o["a"],"app-datepicker":s["a"]},data:function(){var e=new Date;e.setHours(0,0,0,0);var t=["".concat(e.getFullYear(),"-").concat(b(e.getMonth()+1,2),"-01"),"".concat(e.getFullYear(),"-").concat(b(e.getMonth()+1,2),"-").concat(b(e.getDate(),2))];return{loading:!1,dateformat:d.a,dialog:{value:!1,headers:p,items:[],title:""},dataItems:[],dataHeaders:p,expanded:[],singleExpand:!0,items:[],headers:m,types:[{text:"By Lead",value:"lead"},{text:"By Affiliate",value:"affiliate"},{text:"By Agent",value:"agent"}],type:"lead",autocomplete:{value:"",bind:{collection:"customer",itemValue:"_id",itemText:"name",hideAddNew:!0,label:"Select a lead",searchFields:["name","tpc"]}},subaffiliateValue:null,subaffiliateBind:{or:!1,query:{affiliate:"!"}},dates:t}},watch:{isAffiliate:function(e){e||(this.subaffiliateValue=null)},type:function(e){switch(this.items=[],this.autocomplete.value="",e){case"lead":this.autocomplete.bind.collection="customer",this.autocomplete.bind.itemText="name",this.autocomplete.bind.label="Select a lead",this.autocomplete.bind.searchFields=["name","tpc"],delete this.autocomplete.bind.or,delete this.autocomplete.bind.query,this.headers=m,this.dataHeaders=p,this.items=[];break;case"affiliate":this.autocomplete.bind.collection="affiliate",this.autocomplete.bind.itemText="name",this.autocomplete.bind.label="Select an affiliate",delete this.autocomplete.bind.searchFields,delete this.autocomplete.bind.or,delete this.autocomplete.bind.query,this.headers=f,this.dataHeaders=y,this.items=[];break;case"agent":this.autocomplete.bind.collection="user",this.autocomplete.bind.itemText="displayName",this.autocomplete.bind.label="Select an agent",delete this.autocomplete.bind.searchFields,this.autocomplete.bind.or=!1,this.autocomplete.bind.query={role:["!wakel","!affiliate"]},this.headers=v,this.dataHeaders=h,this.items=[];break}}},computed:{isAffiliate:function(){return"affiliate"==this.type}},methods:Object(l["a"])(Object(l["a"])({},Object(u["b"])({get:"api/get"})),{},{getDeposits:function(e){var t=e.map((function(e){return e.child.length}));return t.length?t.reduce((function(e,t){return e+t})):0},innerListClick:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:"affiliate"==t.type&&(t.dialog.value=!0,t.dialog.items=e.child,t.dialog.title="( <small>".concat(e.customer.tpc,"</small> ) ").concat(e.customer.name)),"agent"==t.type&&(t.dialog.value=!0,t.dialog.items=e.child,t.dialog.title="( <small>".concat(e.tpc,"</small> ) ").concat(e.name));case 2:case"end":return a.stop()}}),a)})))()},setTag:function(e){this.isAffiliate&&(this.$refs.subaffiliate.query.affiliate=e||"!",e||(this.subaffiliateValue=null))},submit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=18;break}t.t0=e.type,t.next="lead"===t.t0?4:"affiliate"===t.t0?6:"agent"===t.t0?8:10;break;case 4:return a="report",t.abrupt("break",10);case 6:return a="report/affiliate",t.abrupt("break",10);case 8:return a="report/agent",t.abrupt("break",10);case 10:return e.loading=!0,t.next=13,e.get({collection:a,query:{created_on:e.dates.join("|"),id:e.autocomplete.value||null,subaffiliate:e.subaffiliateValue}});case 13:n=t.sent,n&&(e.items=n.data),e.loading=!1,t.next=19;break;case 18:e.$store.commit("error","form not valid");case 19:case"end":return t.stop()}}),t)})))()}})},x=g,T=a("2877"),_=a("6544"),D=a.n(_),k=a("8336"),w=a("b0af"),M=a("99d9"),S=a("62ad"),N=a("a523"),A=a("8fea"),F=a("169a"),V=a("ce7e"),H=a("4bd4"),C=a("132d"),U=a("0fd9"),O=a("b974"),I=a("3129"),P=Object(T["a"])(x,n,i,!1,null,null,null);t["default"]=P.exports;D()(P,{VBtn:k["a"],VCard:w["a"],VCardActions:M["b"],VCardText:M["d"],VCardTitle:M["e"],VCol:S["a"],VContainer:N["a"],VDataTable:A["a"],VDialog:F["a"],VDivider:V["a"],VForm:H["a"],VIcon:C["a"],VRow:U["a"],VSelect:O["a"],VSkeletonLoader:I["a"]})},"9db7":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{prependInnerIcon:"mdi-calendar",rounded:"",outlined:"",dense:"",value:e.dateRangeText,label:"Date",readonly:"","hide-details":"",clearable:""},on:{"click:clear":e.clear}},"v-text-field",i,!1),n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-date-picker",{attrs:{range:""},on:{input:e.input},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1)},i=[],r=(a("a15b"),{name:"date-picker",props:{value:Array},data:function(){return{menu:!1,dates:[]}},methods:{input:function(e){e.length>1&&(this.menu=!1,this.$emit("input",e))},clear:function(){this.dates=[],this.$emit("input",[])}},computed:{dateRangeText:function(){return this.dates.join(" ~ ")}},created:function(){this.value&&(this.dates=this.value)}}),l=r,o=a("2877"),s=a("6544"),u=a.n(s),c=a("2e4b"),d=a("e449"),m=a("8654"),f=Object(o["a"])(l,n,i,!1,null,null,null);t["a"]=f.exports;u()(f,{VDatePicker:c["a"],VMenu:d["a"],VTextField:m["a"]})},b9b9:function(e,t,a){var n;(function(i){"use strict";var r=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g;return function(n,i,c,d){if(1!==arguments.length||"string"!==u(n)||/\d/.test(n)||(i=n,n=void 0),n=n||new Date,n instanceof Date||(n=new Date(n)),isNaN(n))throw TypeError("Invalid date");i=String(r.masks[i]||i||r.masks["default"]);var m=i.slice(0,4);"UTC:"!==m&&"GMT:"!==m||(i=i.slice(4),c=!0,"GMT:"===m&&(d=!0));var f=c?"getUTC":"get",v=n[f+"Date"](),p=n[f+"Day"](),y=n[f+"Month"](),h=n[f+"FullYear"](),b=n[f+"Hours"](),g=n[f+"Minutes"](),x=n[f+"Seconds"](),T=n[f+"Milliseconds"](),_=c?0:n.getTimezoneOffset(),D=o(n),k=s(n),w={d:v,dd:l(v),ddd:r.i18n.dayNames[p],dddd:r.i18n.dayNames[p+7],m:y+1,mm:l(y+1),mmm:r.i18n.monthNames[y],mmmm:r.i18n.monthNames[y+12],yy:String(h).slice(2),yyyy:h,h:b%12||12,hh:l(b%12||12),H:b,HH:l(b),M:g,MM:l(g),s:x,ss:l(x),l:l(T,3),L:l(Math.round(T/10)),t:b<12?r.i18n.timeNames[0]:r.i18n.timeNames[1],tt:b<12?r.i18n.timeNames[2]:r.i18n.timeNames[3],T:b<12?r.i18n.timeNames[4]:r.i18n.timeNames[5],TT:b<12?r.i18n.timeNames[6]:r.i18n.timeNames[7],Z:d?"GMT":c?"UTC":(String(n).match(t)||[""]).pop().replace(a,""),o:(_>0?"-":"+")+l(100*Math.floor(Math.abs(_)/60)+Math.abs(_)%60,4),S:["th","st","nd","rd"][v%10>3?0:(v%100-v%10!=10)*v%10],W:D,N:k};return i.replace(e,(function(e){return e in w?w[e]:e.slice(1,e.length-1)}))}}();function l(e,t){e=String(e),t=t||2;while(e.length<t)e="0"+e;return e}function o(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var a=new Date(t.getFullYear(),0,4);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var n=t.getTimezoneOffset()-a.getTimezoneOffset();t.setHours(t.getHours()-n);var i=(t-a)/6048e5;return 1+Math.floor(i)}function s(e){var t=e.getDay();return 0===t&&(t=7),t}function u(e){return null===e?"null":void 0===e?"undefined":"object"!==typeof e?typeof e:Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}r.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},r.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},n=function(){return r}.call(t,a,t,e),void 0===n||(e.exports=n)})()}}]);
//# sourceMappingURL=chunk-69751eb4.0724de08.js.map